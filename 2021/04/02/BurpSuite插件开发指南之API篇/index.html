<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="BurpSuite插件开发指南之 API(上下篇)0x00 前言BurpSuite 作为一款 Web 安全测试的利器，得益于其强大的代理，操控数据的功能，在 Web  安全测试过程中，为我们省下了不少时间和精力专注于漏洞的挖掘和测试。更重要的是 BurpSuite 提供了插件开发接口，Web  安全测试人员可以根据实际需求自己开发出提高安全测试效率的插件，虽然 BApp Store  上面已经提供">
<meta property="og:type" content="article">
<meta property="og:title" content="BurpSuite插件开发指南之API篇">
<meta property="og:url" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/index.html">
<meta property="og:site_name" content="一灯和尚&#39;s Blogs">
<meta property="og:description" content="BurpSuite插件开发指南之 API(上下篇)0x00 前言BurpSuite 作为一款 Web 安全测试的利器，得益于其强大的代理，操控数据的功能，在 Web  安全测试过程中，为我们省下了不少时间和精力专注于漏洞的挖掘和测试。更重要的是 BurpSuite 提供了插件开发接口，Web  安全测试人员可以根据实际需求自己开发出提高安全测试效率的插件，虽然 BApp Store  上面已经提供">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/7.jpg">
<meta property="og:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/8.jpg">
<meta property="og:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/9.jpg">
<meta property="og:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/10.jpg">
<meta property="og:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/11.jpg">
<meta property="og:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/12.jpg">
<meta property="og:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/13.jpg">
<meta property="og:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/14.jpg">
<meta property="article:published_time" content="2021-04-02T07:31:00.000Z">
<meta property="article:modified_time" content="2021-04-02T07:35:12.451Z">
<meta property="article:author" content="一灯和尚">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/7.jpg">

<link rel="canonical" href="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>BurpSuite插件开发指南之API篇 | 一灯和尚's Blogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">一灯和尚's Blogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">沉迷学习，无法自拔</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/mrknow001" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/46807619.jpg">
      <meta itemprop="name" content="一灯和尚">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一灯和尚's Blogs">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          BurpSuite插件开发指南之API篇
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-04-02 15:31:00 / 修改时间：15:35:12" itemprop="dateCreated datePublished" datetime="2021-04-02T15:31:00+08:00">2021-04-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="BurpSuite插件开发指南之-API-上下篇"><a href="#BurpSuite插件开发指南之-API-上下篇" class="headerlink" title="BurpSuite插件开发指南之 API(上下篇)"></a>BurpSuite插件开发指南之 API(上下篇)</h1><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>BurpSuite 作为一款 Web 安全测试的利器，得益于其强大的代理，操控数据的功能，在 Web  安全测试过程中，为我们省下了不少时间和精力专注于漏洞的挖掘和测试。更重要的是 BurpSuite 提供了插件开发接口，Web  安全测试人员可以根据实际需求自己开发出提高安全测试效率的插件，虽然 BApp Store  上面已经提供了很多插件，其中也不乏优秀好用的插件，但是作为一名专业的 Web 安全测试人员，有必要熟练掌握 BurpSuite  插件开发技术。国内针对 BurpSuite 插件开发的技术文档并不是很多，也不够全面，《BurpSuite 插件开发指南》系列文章作为  BurpSuite 非官方非权威开发指南，希望在这块填补一些空白。文章中难免有纰漏，望读者自行验证并及时指出。</p>
<p>《BurpSuite 插件开发指南》系列文章如下：</p>
<ul>
<li>《BurpSuite插件开发指南之 API 篇》</li>
<li>《BurpSuite插件开发指南之 Java 篇》</li>
<li>《BurpSuite插件开发指南之 Python 篇》</li>
</ul>
<p>在第一篇文章中，笔者将会介绍 BurpSuite 所提供的开发接口的功能和参数说明，但是不会对 BurpSuite 本身所提供的功能作太多说明。剩余两篇则会分别使用案例阐述 Java 和 Python 进行插件开发的技术。其中会用到 Java 的 Swing 包进行 GUI 编程。</p>
<h2 id="0x01-BurpSuite-插件开发说明"><a href="#0x01-BurpSuite-插件开发说明" class="headerlink" title="0x01 BurpSuite 插件开发说明"></a>0x01 BurpSuite 插件开发说明</h2><p>BurpSuite 插件扩展开发所支持的编程语言有 Java 和 Python，使用这两种开发语言开发的插件在功能上并没有太多区别，使用原生的 Java  开发的插件要比 Python 开发的插件，加载和执行效率更高。所以，笔者推荐使用 Java 作为插件开发的首选语言。</p>
<h4 id="SDK："><a href="#SDK：" class="headerlink" title="SDK："></a>SDK：</h4><ul>
<li>开发文档: BurpSuite 插件开发文档在线地址： <a href="BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/0.jpg">BurpSuite Extension Dev Doc</a> 或者可以在 BurpSuite 程序的 <strong>“Extender”</strong> 标签下的 <strong>“APIs”</strong> 子标签里找到。</li>
<li>SDK 包: 目前，BurpSuite 官网已经不再提供 SDK 包文件的下载，读者可以从 BurpSuite 程序中导出。</li>
<li>JPython：使用 Python 开发插件，需要先安装 <a href="BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/6.jpg">JPython</a> 。</li>
</ul>
<p>注：导出 SDK 包文件操作步骤： “Extender — APIs － Save interface files（左下角）”</p>
<h4 id="开发-IDE："><a href="#开发-IDE：" class="headerlink" title="开发 IDE："></a>开发 IDE：</h4><ul>
<li>使用 Java 开发插件的读者可以使用 Eclipse 这款强大的 IDE 。当然也可以使用其他 Java 开发 IDE，如 IDEA。</li>
<li>使用 Python 开发插件的读者也可以使用 Eclipse （需要安装 PyDev 插件）作为插件开发的 IDE，或者使用 Notepad++， PyCharm。</li>
</ul>
<p>注：推荐使用 Eclipse 作为插件开发 IDE, 除了 Java 之外，Eclipse 对 JPython 也有很好的支持。</p>
<h4 id="辅助工具："><a href="#辅助工具：" class="headerlink" title="辅助工具："></a>辅助工具：</h4><ul>
<li><a href="BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/2.jpg">Swing Inspector</a> 是一个 Java Swing/AWT 用户界面分析、调试工具。可以快速调试，定位问题，提高开发效率。</li>
</ul>
<p>学习资料：</p>
<p>BurpSuite 官方并未提供详细的开发文档，只有少量的开发实例，可以 <a target="_blank" rel="noopener" href="https://portswigger.net/burp/extender/">在此找到</a> 。不过，BurpSuite 官方建立了 <a target="_blank" rel="noopener" href="http://forum.portswigger.net/">插件开发者社区</a> 和 <a href="BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/3.jpg">博客</a> ，可以帮助开发者解答疑问。</p>
<p>在 乌云Drops 上也有两篇专门介绍 BurpSuite 插件开发的文章，读者可以参考：</p>
<ul>
<li>[BurpSuite 扩展开发<a target="_blank" rel="noopener" href="http://drops.wooyun.org/papers/3962">1]-API与HelloWold</a> <a href="BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/4.jpg">By 园长̇̇̇̇̇</a></li>
<li><a target="_blank" rel="noopener" href="http://drops.wooyun.org/tools/5751">burpsuite扩展开发之Python</a> <a href="BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/5.jpg">By 路人甲</a></li>
</ul>
<p>相较于阅读许多参考资料从零开始编写插件，笔者更推荐在熟悉了开发文档后直接在已有的源码中“照猫画虎”进行插件的开发。现有的插件，读者可以在 BApp Store 中找到，Python 版本的插件可以直接查看源码进行学习，Java 版本的插件可以在反编译后查看其源码进行学习。</p>
<p>注：安装了 BApp Store 中的插件后，会在 BurpSuite 所在目录下的 bapps 文件夹中找到插件文件。</p>
<p>插件开发“方法论”：</p>
<p>插件型的应用程序在设计时就一定会考虑插件的开发，因此，主程序与插件之间必然有一种“约定”，在开发插件的过程中，只需按照程序开发者设计的这种“约定”开发就好了，读者在阅读参考官方开发文档时只需注意以下三点：</p>
<ul>
<li>接口方法功能</li>
<li>接口方法入参（参数类型和参数个数）</li>
<li>接口方法的返回值（返回值类型）</li>
</ul>
<p>在关注上述三点以后，就可以把多个接口方法联系在一起，组织起一定的逻辑，这样，开发的思路就顺理成章了。</p>
<h2 id="0x02-API-参考"><a href="#0x02-API-参考" class="headerlink" title="0x02 API 参考"></a>0x02 API 参考</h2><p>本节将对 BurpSuite 的官方文档做简要的说明，并给出简单的 Demo code，各个接口具体的使用实例，可以在笔者后续的两篇文章中看到。</p>
<h3 id="IBurpExtender-接口"><a href="#IBurpExtender-接口" class="headerlink" title="IBurpExtender 接口"></a>IBurpExtender 接口</h3><h4 id="public-interface-IBurpExtender"><a href="#public-interface-IBurpExtender" class="headerlink" title="public interface IBurpExtender"></a>public interface IBurpExtender</h4><p>所有的扩展必须实现此接口，实现的类名必须为“BurpExtender”。在 burp 包中，必须申明为 public ,并且必须提供一个默认的构造器。此接口实现了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line"></span><br><span class="line">void registerExtenderCallbacks(IBurpExtenderCallbacks callbacks)</span><br></pre></td></tr></table></figure>

<p>此方法将在扩展加载后被调用，它注册了一个 IBurpExtenderCallbacks 接口的实例， IBurpExtenderCallbacks 接口提供了许多在开发插件过程中常用的一些操作。</p>
<p>参数说明:</p>
<ul>
<li>callbacks 是一个 <strong>IBurpExtenderCallbacks</strong> 对象。</li>
</ul>
<p>Demo code：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!java</span></span><br><span class="line">package burp;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BurpExtender</span> <span class="keyword">implements</span> <span class="title">IBurpExtender</span></span>&#123;</span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> registerExtenderCallbacks(<span class="keyword">final</span> IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line">        <span class="comment">// TODO here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IBurpExtenderCallbacks"><a href="#IBurpExtenderCallbacks" class="headerlink" title="IBurpExtenderCallbacks"></a>IBurpExtenderCallbacks</h3><h4 id="public-interface-IBurpExtenderCallbacks"><a href="#public-interface-IBurpExtenderCallbacks" class="headerlink" title="public interface IBurpExtenderCallbacks"></a>public interface IBurpExtenderCallbacks</h4><p>此接口中实现的方法和字段在插件开发过程中会经常使用到。 Burp Suite 利用此接口向扩展中传递了许多回调方法，这些回调方法可被用于在 Burp 中执行多个操作。当扩展被加载后，Burp 会调用 registerExtenderCallbacks() 方法，并传递一个 IBurpExtenderCallbacks 的实例。扩展插件可以通过这个实例调用很多扩展 Burp 功能必需的方法。如：设置扩展插件的属性，操作 HTTP 请求和响应以及启动其他扫描功能等等。</p>
<p>此接口提供了很多的方法和字段，在此不一一列举，具体的说明可以在 burp SDK 中的 IBurpExtenderCallbacks.java 或 <a target="_blank" rel="noopener" href="https://portswigger.net/burp/extender/api/burp/IBurpExtenderCallbacks.html">https://portswigger.net/burp/extender/api/burp/IBurpExtenderCallbacks.html</a> 中查看。</p>
<p>Demo code：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!java</span></span><br><span class="line">package burp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BurpExtender</span> <span class="keyword">implements</span> <span class="title">IBurpExtender</span></span>&#123;</span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> registerExtenderCallbacks(<span class="keyword">final</span> IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line">        callbacks.setExtensionName(<span class="string">&quot;Her0in&quot;</span>); <span class="comment">//设置扩展名称为 “Her0in”</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IContextMenuFactory"><a href="#IContextMenuFactory" class="headerlink" title="IContextMenuFactory"></a>IContextMenuFactory</h3><h4 id="public-interface-IContextMenuFactory"><a href="#public-interface-IContextMenuFactory" class="headerlink" title="public interface IContextMenuFactory"></a>public interface IContextMenuFactory</h4><p>Burp 的作者在设计上下文菜单功能中采用了工厂模式的设计模式，扩展可以实现此接口，然后调用 IBurpExtenderCallbacks.registerContextMenuFactory() 注册自定义上下文菜单项的工厂。</p>
<p>此接口提供了如下方法：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">java<span class="selector-class">.util</span><span class="selector-class">.List</span>&lt;javax<span class="selector-class">.swing</span><span class="selector-class">.JMenuItem</span>&gt;   createMenuItems(IContextMenuInvocation invocation)</span><br></pre></td></tr></table></figure>

<p>当用户在 Burp 中的任何地方调用一个上下文菜单时，Burp 则会调用这个工厂方法。此方法会根据菜单调用的细节，提供应该被显示在上下文菜单中的任何自定义上下文菜单项。</p>
<p>参数说明：</p>
<ul>
<li>invocation - 一个实现 <strong>IMessageEditorTabFactory</strong> 接口的对象, 通过此对象可以获取上下文菜单调用的细节。</li>
</ul>
<p>返回值：</p>
<p>此工厂方法将会返回需要被显示的自定义菜单项的一个列表（包含子菜单，checkbox 菜单项等等）， 若无菜单项显示，此工厂方法会返回 null 。</p>
<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import javax.swing.JMenu;</span><br><span class="line">import javax.swing.JMenuItem;</span><br><span class="line"></span><br><span class="line">public class BurpExtender implements IBurpExtender, IContextMenuFactory&#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"></span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerContextMenuFactory(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;JMenuItem&gt; createMenuItems(final IContextMenuInvocation invocation) &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;JMenuItem&gt; listMenuItems &#x3D; new ArrayList&lt;JMenuItem&gt;();</span><br><span class="line">        &#x2F;&#x2F;子菜单</span><br><span class="line">        JMenuItem menuItem;</span><br><span class="line">        menuItem &#x3D; new JMenuItem(&quot;子菜单测试&quot;);  </span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;父级菜单</span><br><span class="line">        JMenu jMenu &#x3D; new JMenu(&quot;Her0in&quot;);</span><br><span class="line">        jMenu.add(menuItem);        </span><br><span class="line">        listMenuItems.add(jMenu);</span><br><span class="line">        return listMenuItems;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IContextMenuInvocation"><a href="#IContextMenuInvocation" class="headerlink" title="IContextMenuInvocation"></a>IContextMenuInvocation</h3><h4 id="public-interface-IContextMenuInvocation"><a href="#public-interface-IContextMenuInvocation" class="headerlink" title="public interface IContextMenuInvocation"></a>public interface IContextMenuInvocation</h4><p>此接口被用于获取当 Burp 调用扩展提供的 IContextMenuFactory 工厂里的上下文菜单时的一些细节，如能获取到调用了扩展提供的自定义上下文菜单的 Burp 工具名称（在 IBurpExtenderCallbacks 中定义）或功能组件的名称（在 IContextMenuInvocation 中定义）。</p>
<p>此接口提供了如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">&#x2F;&#x2F; 此方法可被用于获取本地Java输入事件，并作为上下文菜单调用的触发器</span><br><span class="line">java.awt.event.InputEvent   getInputEvent()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法被用于获取上下文中被调用的菜单</span><br><span class="line">byte    getInvocationContext()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法被用于获取用户选中的 Scanner 问题的细节</span><br><span class="line">IScanIssue[]    getSelectedIssues()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法被用于获取当前显示的或用户选中的 HTTP 请求&#x2F;响应的细节</span><br><span class="line">IHttpRequestResponse[]  getSelectedMessages()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法被用于获取用户所选的当前消息的界限（消息需可适用）</span><br><span class="line">int[]   getSelectionBounds()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法被用于获取调用上下文菜单的 Burp 工具</span><br><span class="line">int getToolFlag()</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import javax.swing.JMenu;</span><br><span class="line">import javax.swing.JMenuItem;</span><br><span class="line"></span><br><span class="line">public class BurpExtender implements IBurpExtender, IContextMenuFactory&#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerContextMenuFactory(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;JMenuItem&gt; createMenuItems(final IContextMenuInvocation invocation) &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;JMenuItem&gt; listMenuItems &#x3D; new ArrayList&lt;JMenuItem&gt;();</span><br><span class="line">        &#x2F;&#x2F; 菜单只在 REPEATER 工具的右键菜单中显示</span><br><span class="line">        if(invocation.getToolFlag() &#x3D;&#x3D; IBurpExtenderCallbacks.TOOL_REPEATER)&#123;</span><br><span class="line">            &#x2F;&#x2F;子菜单</span><br><span class="line">            JMenuItem menuItem;</span><br><span class="line">            menuItem &#x3D; new JMenuItem(&quot;子菜单测试&quot;);  </span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;父级菜单</span><br><span class="line">            JMenu jMenu &#x3D; new JMenu(&quot;Her0in&quot;);</span><br><span class="line">            jMenu.add(menuItem);        </span><br><span class="line">            listMenuItems.add(jMenu);</span><br><span class="line">        &#125;</span><br><span class="line">        return listMenuItems;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ICookie"><a href="#ICookie" class="headerlink" title="ICookie"></a>ICookie</h3><h4 id="public-interface-ICookie"><a href="#public-interface-ICookie" class="headerlink" title="public interface ICookie"></a>public interface ICookie</h4><p>此接口用于获取 HTTP cookie 的一些信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 Cookie 的域</span><br><span class="line">java.lang.String    getDomain()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 Cookie 的过期时间</span><br><span class="line">java.util.Date  getExpiration()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 Cookie 的名称</span><br><span class="line">java.lang.String    getName()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 Cookie 的路径</span><br><span class="line">java.lang.String    getPath()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 Cookie 的值</span><br><span class="line">java.lang.String    getValue()</span><br></pre></td></tr></table></figure>

<h3 id="IExtensionHelpers"><a href="#IExtensionHelpers" class="headerlink" title="IExtensionHelpers"></a>IExtensionHelpers</h3><h4 id="public-interface-IExtensionHelpers"><a href="#public-interface-IExtensionHelpers" class="headerlink" title="public interface IExtensionHelpers"></a>public interface IExtensionHelpers</h4><p>此接口提供了很多常用的辅助方法，扩展可以通过调用 IBurpExtenderCallbacks.getHelpers获得此接口的实例。</p>
<p>开发插件常用的几个方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法会添加一个新的参数到 HTTP 请求中，并且会适当更新 Content-Length</span><br><span class="line">byte[]  addParameter(byte[] request, IParameter parameter)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于分析 HTTP 请求信息以便获取到多个键的值</span><br><span class="line">IRequestInfo    analyzeRequest(byte[] request)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于分析 HTTP 响应信息以便获取到多个键的值</span><br><span class="line">IResponseInfo   analyzeResponse(byte[] response)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 构建包含给定的 HTTP 头部，消息体的 HTTP 消息</span><br><span class="line">byte[]  buildHttpMessage(java.util.List&lt;java.lang.String&gt; headers, byte[] body)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 对给定的 URL 发起 GET 请求</span><br><span class="line">byte[]  buildHttpRequest(java.net.URL url)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; bytes 到 String 的转换</span><br><span class="line">java.lang.String    bytesToString(byte[] data)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; String 到 bytes 的转</span><br><span class="line">java.lang.String    bytesToString(byte[] data)</span><br></pre></td></tr></table></figure>

<h3 id="IExtensionStateListener"><a href="#IExtensionStateListener" class="headerlink" title="IExtensionStateListener"></a>IExtensionStateListener</h3><h4 id="public-interface-IExtensionStateListener"><a href="#public-interface-IExtensionStateListener" class="headerlink" title="public interface IExtensionStateListener"></a>public interface IExtensionStateListener</h4><p>扩展可以实现此接口，然后调用 IBurpExtenderCallbacks.registerExtensionStateListener() 注册一个扩展的状态监听器。在扩展的状态发生改变时，监听器将会收到通知。注意：任何启动后台线程或打开系统资源（如文件或数据库连接）的扩展插件都应该注册一个监听器，并在被卸载后终止线程/关闭资源。</p>
<p>此接口只提供了一个方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">void    extensionUnloaded()</span><br></pre></td></tr></table></figure>

<p>在插件被 unload （卸载）时，会调用此方法，可以通过重写此方法，在卸载插件时，做一些善后处理工作。</p>
<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IExtensionStateListener&#123;</span><br><span class="line"> </span><br><span class="line">    private PrintWriter stdout;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true);</span><br><span class="line"> </span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        &#x2F;&#x2F; 先注册扩展状态监听器</span><br><span class="line">        callbacks.registerExtensionStateListener(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    &#x2F;&#x2F; 重写 extensionUnloaded 方法</span><br><span class="line">    @Override</span><br><span class="line">    public void extensionUnloaded() &#123;</span><br><span class="line">        &#x2F;&#x2F; TODO </span><br><span class="line">        this.stdout.println(&quot;extensionUnloaded ...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IHttpListener"><a href="#IHttpListener" class="headerlink" title="IHttpListener"></a>IHttpListener</h3><h4 id="public-interface-IHttpListener"><a href="#public-interface-IHttpListener" class="headerlink" title="public interface IHttpListener"></a>public interface IHttpListener</h4><p>扩展可以实现此接口。通过调用 IBurpExtenderCallbacks.registerHttpListener() 注册一个 HTTP 监听器。Burp 里的任何一个工具发起 HTTP 请求或收到 HTTP 响应都会通知此监听器。扩展可以得到这些交互的数据，进行分析和修改。</p>
<p>此接口提供了如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">void    processHttpMessage(int toolFlag, boolean messageIsRequest, IHttpRequestResponse messageInfo)</span><br></pre></td></tr></table></figure>

<p>如果在开发插件的时候需要获取到所有的 HTTP 数据包，包括通过 Repeater 工具自定义修改的请求，则必须实现此接口，重写该方法。</p>
<p>参数说明：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">&#x2F;&#x2F; 指示了发起请求或收到响应的 Burp 工具的 ID，所有的 toolFlag 定义在 IBurpExtenderCallbacks 接口中。</span><br><span class="line">int toolFlag</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 指示该消息是请求消息（值为True）还是响应消息（值为False）</span><br><span class="line">messageIsRequest</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 被处理的消息的详细信息，是一个 IHttpRequestResponse 对象</span><br><span class="line">messageInfo</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IHttpListener&#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerHttpListener(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void processHttpMessage(int toolFlag, boolean messageIsRequest,</span><br><span class="line">            IHttpRequestResponse messageInfo) &#123;</span><br><span class="line"> </span><br><span class="line">        &#x2F;&#x2F; TODO here</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IHttpRequestResponse"><a href="#IHttpRequestResponse" class="headerlink" title="IHttpRequestResponse"></a>IHttpRequestResponse</h3><h4 id="public-interface-IHttpRequestResponse"><a href="#public-interface-IHttpRequestResponse" class="headerlink" title="public interface IHttpRequestResponse"></a>public interface IHttpRequestResponse</h4><p>此接口用于检索和更新有关 HTTP 消息的详细信息。</p>
<p>注意：setter 方法通常只能在消息被被处理之前使用，因为它是一个写操作，因此在只读的上下文中也是不可用的。与响应细节相关的 getter 方法只能用在请求发出后使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 获取用户标注的注释信息</span><br><span class="line">java.lang.String    getComment()</span><br><span class="line">&#x2F;&#x2F; 获取用户标注的高亮信息</span><br><span class="line">java.lang.String    getHighlight()</span><br><span class="line">&#x2F;&#x2F; 获取请求&#x2F;响应的 HTTP 服务信息</span><br><span class="line">IHttpService    getHttpService()</span><br><span class="line">&#x2F;&#x2F; 获取 HTTP 请求信息</span><br><span class="line">byte[]  getRequest()</span><br><span class="line">&#x2F;&#x2F; 获取 HTTP 响应信息</span><br><span class="line">byte[]  getResponse()</span><br><span class="line">&#x2F;&#x2F; 更新用户标注的注释信息</span><br><span class="line">void    setComment(java.lang.String comment)</span><br><span class="line">&#x2F;&#x2F; 更新用户标注的高亮信息</span><br><span class="line">void    setHighlight(java.lang.String color)</span><br><span class="line">&#x2F;&#x2F; 更新 请求&#x2F;响应的 HTTP 服务信息 </span><br><span class="line">void    setHttpService(IHttpService httpService)</span><br><span class="line">&#x2F;&#x2F; 更新 HTTP 请求信息</span><br><span class="line">void    setRequest(byte[] message)</span><br><span class="line">&#x2F;&#x2F; 更新 HTTP 响应信息</span><br><span class="line">void    setResponse(byte[] message)</span><br></pre></td></tr></table></figure>

<h3 id="IHttpRequestResponsePersisted"><a href="#IHttpRequestResponsePersisted" class="headerlink" title="IHttpRequestResponsePersisted"></a>IHttpRequestResponsePersisted</h3><h4 id="public-interface-IHttpRequestResponsePersisted-extends-IHttpRequestResponse"><a href="#public-interface-IHttpRequestResponsePersisted-extends-IHttpRequestResponse" class="headerlink" title="public interface IHttpRequestResponsePersisted extends IHttpRequestResponse"></a>public interface IHttpRequestResponsePersisted extends IHttpRequestResponse</h4><p>此接口是 IHttpRequestResponse 接口的一个子接口，该接口用于使用 IBurpExtenderCallbacks.saveBuffersToTempFiles() 将一个IHttpRequestResponse 对象的请求和响应消息保存到临时文件。</p>
<p>此接口只提供了一个方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">void    deleteTempFiles()</span><br></pre></td></tr></table></figure>

<p>注：此方法已经过时了，并且不会执行任何操作。</p>
<h3 id="IHttpRequestResponseWithMarkers"><a href="#IHttpRequestResponseWithMarkers" class="headerlink" title="IHttpRequestResponseWithMarkers"></a>IHttpRequestResponseWithMarkers</h3><h4 id="public-interface-IHttpRequestResponseWithMarkers-extends-IHttpRequestResponse"><a href="#public-interface-IHttpRequestResponseWithMarkers-extends-IHttpRequestResponse" class="headerlink" title="public interface IHttpRequestResponseWithMarkers extends IHttpRequestResponse"></a>public interface IHttpRequestResponseWithMarkers extends IHttpRequestResponse</h4><p>此接口是 IHttpRequestResponse 接口的一个子接口，此接口用于那些已被标记的 IHttpRequestResponse 对象，扩展可以使用 IBurpExtenderCallbacks.applyMarkers() 创建一个此接口的实例，或提供自己的实现。标记可用于各种情况，如指定Intruder 工具的 payload 位置，Scanner 工具的插入点或将 Scanner 工具的一些问题置为高亮。</p>
<p>此接口提供了两个分别操作请求和响应的方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 获取带有标记的请求信息的详细信息</span><br><span class="line">java.util.List&lt;int[]&gt;   getRequestMarkers()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 获取带有标记的请求信息的详细信息</span><br><span class="line">java.util.List&lt;int[]&gt;   getResponseMarkers()</span><br></pre></td></tr></table></figure>

<p>这两个方法的返回值均为一个整型数组列表，分别表示请求消息/响应消息标记偏移的索引对。列表中的每一项目都是一个长度为 2 的整型数组（int <a href="BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/6.jpg">2</a> ）包含标记开始和结束的偏移量。如果没有定义请求/响应标记，返回 null。</p>
<h3 id="IHttpService"><a href="#IHttpService" class="headerlink" title="IHttpService"></a>IHttpService</h3><h4 id="public-interface-IHttpService"><a href="#public-interface-IHttpService" class="headerlink" title="public interface IHttpService"></a>public interface IHttpService</h4><p>此接口用于提供关于 HTTP 服务信息的细节。</p>
<p>此接口提供了如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 返回 HTTP 服务信息的主机名或 IP 地址</span><br><span class="line">java.lang.String    getHost()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 返回 HTTP 服务信息的端口</span><br><span class="line">int getPort()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 返回 HTTP 服务信息的协议</span><br><span class="line">java.lang.String    getProtocol()</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IHttpListener&#123;</span><br><span class="line"> </span><br><span class="line">    private PrintWriter stdout;</span><br><span class="line">    public IBurpExtenderCallbacks iCallbacks;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true); </span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerHttpListener(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void processHttpMessage(int toolFlag, boolean messageIsRequest,</span><br><span class="line">            IHttpRequestResponse messageInfo) &#123;</span><br><span class="line"> </span><br><span class="line">        IHttpService iHttpService &#x3D; messageInfo.getHttpService();</span><br><span class="line"> </span><br><span class="line">        this.stdout.println(iHttpService.getHost());</span><br><span class="line">        this.stdout.println(iHttpService.getPort());</span><br><span class="line">        this.stdout.println(iHttpService.getProtocol());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IInterceptedProxyMessage"><a href="#IInterceptedProxyMessage" class="headerlink" title="IInterceptedProxyMessage"></a>IInterceptedProxyMessage</h3><h4 id="public-interface-IInterceptedProxyMessage"><a href="#public-interface-IInterceptedProxyMessage" class="headerlink" title="public interface IInterceptedProxyMessage"></a>public interface IInterceptedProxyMessage</h4><p>注：在 BurpSuite 的 Proxy 工具下的 Options 标签里有几个自定义消息拦截和响应的功能。读者可以在熟悉了这几个功能后，再了解此接口的作用。</p>
<p>此接口不能被扩展实现，它表示了已被 Burp 代理拦截的 HTTP 消息。扩展可以利用此接口注册一个 IProxyListener 以便接收代理消息的细节。</p>
<p>此接口提供了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 获取被拦截的请求消息的客户端 IP 地址</span><br><span class="line">java.net.InetAddress    getClientIpAddress()</span><br><span class="line">     </span><br><span class="line">&#x2F;&#x2F; 获取当前定义的拦截操作类型，具体的类型可以在本接口中看到</span><br><span class="line">int getInterceptAction()</span><br><span class="line">     </span><br><span class="line">&#x2F;&#x2F; 获取 Burp Proxy 处理拦截消息监听器的名称</span><br><span class="line">java.lang.String    getListenerInterface()</span><br><span class="line">     </span><br><span class="line">&#x2F;&#x2F; 获取被拦截的消息的详细信息</span><br><span class="line">IHttpRequestResponse    getMessageInfo()</span><br><span class="line">     </span><br><span class="line">&#x2F;&#x2F; 获取请求&#x2F;响应消息的唯一引用号</span><br><span class="line">int getMessageReference()</span><br><span class="line">     </span><br><span class="line">&#x2F;&#x2F; 设置更新拦截操作</span><br><span class="line">void    setInterceptAction(int interceptAction)</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IProxyListener&#123;</span><br><span class="line"> </span><br><span class="line">    private PrintWriter stdout;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true);</span><br><span class="line">        callbacks.registerProxyListener(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void processProxyMessage(boolean messageIsRequest,</span><br><span class="line">            IInterceptedProxyMessage message) &#123;</span><br><span class="line">        &#x2F;&#x2F; 只操作请求消息</span><br><span class="line">        if(messageIsRequest)&#123;</span><br><span class="line">            &#x2F;&#x2F; 获取并打印出客户端 IP</span><br><span class="line">            this.stdout.println(message.getClientIpAddress());</span><br><span class="line">            &#x2F;&#x2F; Drop 掉所有请求</span><br><span class="line">            message.setInterceptAction(IInterceptedProxyMessage.ACTION_DROP);</span><br><span class="line">            &#x2F;&#x2F; TODO here</span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IIntruderAttack"><a href="#IIntruderAttack" class="headerlink" title="IIntruderAttack"></a>IIntruderAttack</h3><h4 id="public-interface-IIntruderAttack"><a href="#public-interface-IIntruderAttack" class="headerlink" title="public interface IIntruderAttack"></a>public interface IIntruderAttack</h4><p>此接口用于操控 Intruder 工具的攻击详情。</p>
<p>此接口提供了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 获取攻击中的 HTTP 服务信息</span><br><span class="line">IHttpService    getHttpService()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 获取攻击中的请求模版</span><br><span class="line">byte[]  getRequestTemplate()</span><br></pre></td></tr></table></figure>

<h3 id="IIntruderPayloadGenerator"><a href="#IIntruderPayloadGenerator" class="headerlink" title="IIntruderPayloadGenerator"></a>IIntruderPayloadGenerator</h3><h4 id="public-interface-IIntruderPayloadGenerator"><a href="#public-interface-IIntruderPayloadGenerator" class="headerlink" title="public interface IIntruderPayloadGenerator"></a>public interface IIntruderPayloadGenerator</h4><p>此接口被用于自定义 Intruder 工具的 payload 生成器。当需要发起一次新的 Intruder 攻击时，扩展需要注册一个 IIntruderPayloadGeneratorFactory 工厂并且必须返回此接口的一个新的实例。此接口会将当前插件注册为一个 Intruder 工具的 payload 生成器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">此接口提供了如下方法：  </span><br><span class="line">&#x2F;&#x2F; 此方法由 Burp 调用，用于获取下一个 payload 的值</span><br><span class="line">byte[]  getNextPayload(byte[] baseValue)</span><br><span class="line">     </span><br><span class="line">&#x2F;&#x2F; 此方法由 Burp 调用，用于决定 payload 生成器是否能够提供更多 payload</span><br><span class="line">boolean hasMorePayloads()</span><br><span class="line">     </span><br><span class="line">&#x2F;&#x2F; 此方法由 Burp 调用，用于重置 payload 生成器的状态，这将导致下一次调用 getNextPayload() 方法时会返回第一条 payload</span><br><span class="line">void    reset()</span><br></pre></td></tr></table></figure>

<p>Demo code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IIntruderPayloadGeneratorFactory&#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        &#x2F;&#x2F; 将当前插件注册为一个 Intruder 工具的 payload 生成器</span><br><span class="line">        callbacks.registerIntruderPayloadGeneratorFactory(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public String getGeneratorName() &#123;</span><br><span class="line">        &#x2F;&#x2F; 设置 payload 生成器名称</span><br><span class="line">        return &quot;自定义 payload 生成器&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public IIntruderPayloadGenerator createNewInstance(IIntruderAttack attack) &#123;</span><br><span class="line">        &#x2F;&#x2F; 返回一个新的 payload 生成器的实例</span><br><span class="line">        return new IntruderPayloadGenerator();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">     &#x2F;&#x2F; 实现 IIntruderPayloadGenerator 接口，此接口提供的方法是由 Burp 来调用的</span><br><span class="line">    class IntruderPayloadGenerator implements IIntruderPayloadGenerator&#123;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public boolean hasMorePayloads() &#123;</span><br><span class="line">            &#x2F;&#x2F; TODO here</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public byte[] getNextPayload(byte[] baseValue) &#123;</span><br><span class="line">            &#x2F;&#x2F; TODO here</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public void reset() &#123;</span><br><span class="line">            &#x2F;&#x2F; TODO here</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 Burp 加载了上述插件后，可以按照下图标红的步骤操作，即可看到自定义的 payload 生成器：</p>
<p><img src="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/7.jpg" alt="img"></p>
<h3 id="IIntruderPayloadGeneratorFactory"><a href="#IIntruderPayloadGeneratorFactory" class="headerlink" title="IIntruderPayloadGeneratorFactory"></a>IIntruderPayloadGeneratorFactory</h3><h4 id="public-interface-IIntruderPayloadGeneratorFactory"><a href="#public-interface-IIntruderPayloadGeneratorFactory" class="headerlink" title="public interface IIntruderPayloadGeneratorFactory"></a>public interface IIntruderPayloadGeneratorFactory</h4><p>扩展可以实现此接口，并且可以调用 IBurpExtenderCallbacks.registerIntruderPayloadGeneratorFactory() 注册一个自定义的 Intruder 工具的 payload 生成器。</p>
<p>该接口提供了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法由 Burp 调用，用于创建一个 payload 生成器的新实例。当用户发动一次 Intruder 攻击时，将会使用该方法返回的 payload 生成器的实例</span><br><span class="line"></span><br><span class="line">IIntruderPayloadGenerator   createNewInstance(IIntruderAttack attack)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法由 Burp 调用，用于获取 payload 生成器的名称</span><br><span class="line">java.lang.String    getGeneratorName()</span><br></pre></td></tr></table></figure>

<h3 id="IIntruderPayloadProcessor"><a href="#IIntruderPayloadProcessor" class="headerlink" title="IIntruderPayloadProcessor"></a>IIntruderPayloadProcessor</h3><h4 id="public-interface-IIntruderPayloadProcessor"><a href="#public-interface-IIntruderPayloadProcessor" class="headerlink" title="public interface IIntruderPayloadProcessor"></a>public interface IIntruderPayloadProcessor</h4><p>扩展可以实现此接口，并且可以调用 IBurpExtenderCallbacks.registerIntruderPayloadProcessor() 注册一个自定义 Intruder 工具的 payload 的处理器。此接口会将当前插件注册为一个 Intruder 工具的 payload 处理器。</p>
<p>该接口提供了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法由 Burp 调用，用于获取 payload 处理器的名称</span><br><span class="line">java.lang.String    getProcessorName()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此方法由 Burp 调用，当处理器每次应用 payload 到一次 Intruder 攻击时,Burp 都会调用一次此方法</span><br><span class="line">byte[]  processPayload(byte[] currentPayload, byte[] originalPayload, byte[] baseValue)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; processPayload 方法说明：</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li>currentPayload - 当前已被处理过的 payload 的值</li>
<li>originalPayload - 在应用处理规则之前的 payload 的原始值</li>
<li>baseValue - payload 位置的基准值，将用当前已被处理过的 payload 替代</li>
</ul>
<p>返回值:返回已被处理过的 payload 的值。 如果返回 null 意味着当前的 payload 将被跳过,并且此次攻击将被直接移动到下一个 payload 。</p>
<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IIntruderPayloadProcessor&#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        &#x2F;&#x2F; 将当前插件注册为一个 Intruder 工具的 payload 处理器</span><br><span class="line">        callbacks.registerIntruderPayloadProcessor(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    &#x2F;&#x2F; 此方法由 Burp 调用</span><br><span class="line">    @Override</span><br><span class="line">    public String getProcessorName() &#123;</span><br><span class="line">        &#x2F;&#x2F; 设置自定义 payload 处理器的名称</span><br><span class="line">        return &quot;自定义 payload 处理器&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    &#x2F;&#x2F; 此方法由 Burp 调用，且会在每次使用一个 payload 发动攻击时都会调用一次此方法</span><br><span class="line">    @Override</span><br><span class="line">    public byte[] processPayload(byte[] currentPayload, byte[] originalPayload,</span><br><span class="line">            byte[] baseValue) &#123;</span><br><span class="line">        &#x2F;&#x2F; TODO here</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 Burp 加载了上述插件后，可以按照下图标红的步骤操作，即可看到自定义的 payload 生成器：</p>
<p><img src="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/8.jpg" alt="img"></p>
<h3 id="IMenuItemHandler"><a href="#IMenuItemHandler" class="headerlink" title="IMenuItemHandler"></a>IMenuItemHandler</h3><h4 id="public-interface-IMenuItemHandler"><a href="#public-interface-IMenuItemHandler" class="headerlink" title="public interface IMenuItemHandler"></a>public interface IMenuItemHandler</h4><p>此接口已过时，不推荐再使用，请使用IContextMenuFactory代替。</p>
<p>扩展可以实现此接口，并且通过调用 IBurpExtenderCallbacks.registerMenuItem() 方法注册一个自定义的上下文菜单项。</p>
<p>此接口提供了如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 当用户单击一个已经在 Burp 中注册过的上下文菜单项时 Burp 会调用一次此方法。不过，此方法已经过时</span><br><span class="line">void    menuItemClicked(java.lang.String menuItemCaption, IHttpRequestResponse[] messageInfo)  </span><br></pre></td></tr></table></figure>

<h3 id="IMessageEditor"><a href="#IMessageEditor" class="headerlink" title="IMessageEditor"></a>IMessageEditor</h3><h4 id="public-interface-IMessageEditor"><a href="#public-interface-IMessageEditor" class="headerlink" title="public interface IMessageEditor"></a>public interface IMessageEditor</h4><p>此接口被用于使用 Burp 的 HTTP 消息编辑框的实例提供扩展功能，以便扩展插件可以在它自己的 UI 中使用消息编辑框，扩展插件可以通过调用 IBurpExtenderCallbacks.createMessageEditor() 获得此接口的实例。</p>
<p>此接口提供了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法返回了编辑器的 UI 组件，扩展插件可以将其添加到自己的 UI 中</span><br><span class="line">java.awt.Component  getComponent()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取当前已显示的消息，此消息可能已被用户修改</span><br><span class="line">byte[]  getMessage()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回了用户当前所选择的数据</span><br><span class="line">byte[]  getSelectedData()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于决定当前的消息是否可被用户修改</span><br><span class="line">boolean isMessageModified()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于将一个 HTTP 消息显示在编辑器中</span><br><span class="line">void    setMessage(byte[] message, boolean isRequest)</span><br></pre></td></tr></table></figure>

<p>注： 此接口需要与 IMessageEditorTabFactory 等相关接口一起使用。</p>
<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请见 IMessageEditorTabFactory 的实例代码。</span><br></pre></td></tr></table></figure>

<h3 id="IMessageEditorController"><a href="#IMessageEditorController" class="headerlink" title="IMessageEditorController"></a>IMessageEditorController</h3><h4 id="public-interface-IMessageEditorController"><a href="#public-interface-IMessageEditorController" class="headerlink" title="public interface IMessageEditorController"></a>public interface IMessageEditorController</h4><p>此接口被用于 IMessageEditor 获取当前显示的消息的细节。创建了 Burp 的 HTTP 消息编辑器实例的扩展插件可以有选择的实现 IMessageEditorController 接口，当扩展插件需要当前消息的其他信息时，编辑器将会调用此接口（例如：发送当前消息到其他的 Burp 工具中）。扩展通过 IMessageEditorTabFactory 工厂提供自定义的编辑器标签页，此工厂的 createNewInstance 方法接受一个由该工厂所生成的每一个标签页的 IMessageEditorController 对象的引用，当标签页需要当前消息的其他信息时，则会调用该对象。</p>
<p>此方法提供了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法用于获取当前消息的 HTTP 服务信息</span><br><span class="line">IHttpService    getHttpService()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取当前消息的 HTTP 请求（也有可能是一个响应消息）</span><br><span class="line">byte[]  getRequest()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取当前消息的 HTTP 响应（也有可能是一个请求消息）</span><br><span class="line">byte[]  getResponse()</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请见 IMessageEditorTabFactory 的实例代码。</span><br></pre></td></tr></table></figure>

<h3 id="IMessageEditorTab"><a href="#IMessageEditorTab" class="headerlink" title="IMessageEditorTab"></a>IMessageEditorTab</h3><h4 id="public-interface-IMessageEditorTab"><a href="#public-interface-IMessageEditorTab" class="headerlink" title="public interface IMessageEditorTab"></a>public interface IMessageEditorTab</h4><p>扩展插件通过注册 IMessageEditorTabFactory 工厂，此工厂的 createNewInstance 返回一个当前接口的实例，Burp 将会在其 HTTP 消息编辑器中创建自定义的标签页。</p>
<p>此接口提供了如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法返回当前显示的消息</span><br><span class="line">byte[]  getMessage()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取当前已被用户选择的数据</span><br><span class="line">byte[]  getSelectedData()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回自定义标签页的标题</span><br><span class="line">java.lang.String    getTabCaption()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回自定义标签页内容的组件</span><br><span class="line">java.awt.Component  getUiComponent()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于指示在显示一个新的 HTTP 消息时，是否启用自定义的标签页</span><br><span class="line">boolean isEnabled(byte[] content, boolean isRequest)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于决定当前显示的消息是否可被用户修改</span><br><span class="line">boolean isModified()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法可以显示一个新的消息或者清空已存在的消息</span><br><span class="line">void    setMessage(byte[] content, boolean isRequest)</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请见 IMessageEditorTabFactory 的实例代码。</span><br></pre></td></tr></table></figure>

<h3 id="IMessageEditorTabFactory"><a href="#IMessageEditorTabFactory" class="headerlink" title="IMessageEditorTabFactory"></a>IMessageEditorTabFactory</h3><h4 id="public-interface-IMessageEditorTabFactory"><a href="#public-interface-IMessageEditorTabFactory" class="headerlink" title="public interface IMessageEditorTabFactory"></a>public interface IMessageEditorTabFactory</h4><p>扩展可以实现此接口，并且可以调用 IBurpExtenderCallbacks.registerMessageEditorTabFactory() 注册一个自定义的消息编辑器标签页的工厂。扩展插件可以在 Burp 的 HTTP 编辑器中渲染或编辑 HTTP 消息。</p>
<p>此接口提供了一个方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; Burp 将会对每一个 HTTP 消息编辑器调用一次此方法，此工厂必须返回一个新的 IMessageEditorTab 对象</span><br><span class="line">IMessageEditorTab   createNewInstance(IMessageEditorController controller, boolean editable)</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">import java.awt.Component;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IMessageEditorTabFactory&#123;</span><br><span class="line"> </span><br><span class="line">    public PrintWriter stdout;</span><br><span class="line">    public IExtensionHelpers helpers;</span><br><span class="line">    private IBurpExtenderCallbacks callbacks;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true);</span><br><span class="line">        this.callbacks &#x3D; callbacks;</span><br><span class="line">        this.helpers &#x3D; callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerMessageEditorTabFactory(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public IMessageEditorTab createNewInstance(</span><br><span class="line">            IMessageEditorController controller, boolean editable) &#123;</span><br><span class="line">        &#x2F;&#x2F; 返回 IMessageEditorTab 的实例</span><br><span class="line">        return new iMessageEditorTab();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    class iMessageEditorTab implements IMessageEditorTab&#123;</span><br><span class="line"> </span><br><span class="line">        &#x2F;&#x2F; 创建一个新的文本编辑器</span><br><span class="line">        private ITextEditor iTextEditor &#x3D; callbacks.createTextEditor();</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public String getTabCaption() &#123;</span><br><span class="line">            &#x2F;&#x2F; 设置消息编辑器标签页的标题</span><br><span class="line">            return &quot;测试 MessageEditorTab&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public Component getUiComponent() &#123;</span><br><span class="line">            &#x2F;&#x2F; 返回 iTextEditor 的组件信息，当然也可以放置其他的组件</span><br><span class="line">            return iTextEditor.getComponent();</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public boolean isEnabled(byte[] content, boolean isRequest) &#123;</span><br><span class="line">            &#x2F;&#x2F; 在显示一个新的 HTTP 消息时，启用自定义的标签页</span><br><span class="line">            &#x2F;&#x2F; 通过 content 和 isRequest 也可以对特定的消息进行设置</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public void setMessage(byte[] content, boolean isRequest) &#123;</span><br><span class="line">            &#x2F;&#x2F; 把请求消息里面的 data 参数进行 Base64 编码操作</span><br><span class="line">            &#x2F;&#x2F; 这里并未处理参数中没有 data 时的异常</span><br><span class="line">            IParameter parameter &#x3D; helpers.getRequestParameter(content, &quot;data&quot;);</span><br><span class="line">            stdout.println(&quot;data &#x3D; &quot; + parameter.getValue());</span><br><span class="line">            iTextEditor.setText(helpers.stringToBytes(helpers.base64Encode(parameter.getValue())));</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public byte[] getMessage() &#123;</span><br><span class="line">            &#x2F;&#x2F; 获取 iTextEditor 的文本</span><br><span class="line">            return iTextEditor.getText();</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public boolean isModified() &#123;</span><br><span class="line">            &#x2F;&#x2F; 允许用户修改当前的消息</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public byte[] getSelectedData() &#123;</span><br><span class="line">            &#x2F;&#x2F; 直接返回 iTextEditor 中选中的文本</span><br><span class="line">            return iTextEditor.getSelectedText();</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加载上述代码生成的插件后，会显示自定义的标签页和文本编辑器。</p>
<h4 id="注意：官网提供的自定义消息编辑器的代码有误！"><a href="#注意：官网提供的自定义消息编辑器的代码有误！" class="headerlink" title="注意：官网提供的自定义消息编辑器的代码有误！"></a>注意：官网提供的自定义消息编辑器的代码有误！</h4><p><img src="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/9.jpg" alt="img"></p>
<h3 id="IParameter"><a href="#IParameter" class="headerlink" title="IParameter"></a>IParameter</h3><h4 id="public-interface-IParameter"><a href="#public-interface-IParameter" class="headerlink" title="public interface IParameter"></a>public interface IParameter</h4><p>此接口用于操控 HTTP 请求参数，开发者通过此接口可以灵活的获取请求或响应里的参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法用于获取参数名称</span><br><span class="line">java.lang.String    getName()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取在 HTTP 请求里面的最后一个参数的名称</span><br><span class="line">int getNameEnd()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取在 HTTP 请求里面的第一个参数的名称</span><br><span class="line">int getNameStart()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取参数类型，参数的类型在 IParameter 接口中有定义</span><br><span class="line">byte    getType()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取参数的值</span><br><span class="line">java.lang.String    getValue()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取最后一个参数的值</span><br><span class="line">int getValueEnd()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取第一个参数的值</span><br><span class="line">int getValueStart()</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line">import java.util.List;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IHttpListener&#123;</span><br><span class="line"> </span><br><span class="line">    public PrintWriter stdout;</span><br><span class="line">    public IExtensionHelpers helpers;</span><br><span class="line">    private IBurpExtenderCallbacks callbacks;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true);</span><br><span class="line">        this.callbacks &#x3D; callbacks;</span><br><span class="line">        this.helpers &#x3D; callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerHttpListener(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void processHttpMessage(int toolFlag, boolean messageIsRequest,</span><br><span class="line">            IHttpRequestResponse messageInfo) &#123;</span><br><span class="line">        &#x2F;&#x2F; 获取请求中的参数</span><br><span class="line">        if(messageIsRequest)&#123;</span><br><span class="line">            IRequestInfo iRequestInfo &#x3D; helpers.analyzeRequest(messageInfo);</span><br><span class="line">            &#x2F;&#x2F; 获取请求中的所有参数</span><br><span class="line">            List&lt;IParameter&gt; iParameters &#x3D; iRequestInfo.getParameters();</span><br><span class="line">            for (IParameter iParameter : iParameters) &#123;</span><br><span class="line">                if(iParameter.getType() &#x3D;&#x3D; IParameter.PARAM_URL)</span><br><span class="line">                    stdout.println(&quot;参数：&quot; + iParameter.getName() + &quot; 在 URL中&quot;);</span><br><span class="line">                    stdout.println(&quot;参数：&quot; + iParameter.getName() + &quot; 的值为：&quot; + iParameter.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加载上述代码生成的插件后，执行效果如下图所示：</p>
<p><img src="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/10.jpg" alt="img"></p>
<h3 id="IProxyListener"><a href="#IProxyListener" class="headerlink" title="IProxyListener"></a>IProxyListener</h3><h4 id="public-interface-IProxyListener"><a href="#public-interface-IProxyListener" class="headerlink" title="public interface IProxyListener"></a>public interface IProxyListener</h4><p>扩展可以实现此接口，并且可以通过调用 IBurpExtenderCallbacks.registerProxyListener()注册一个代理监听器。在代理工具处理了请求或响应后会通知此监听器。扩展插件通过注册这样一个监听器，对这些消息执行自定义的分析或修改操作。</p>
<p>此接口提供了一个很常用的方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line"><span class="comment">// 当代理工具处理 HTTP 消息时则会调用此方法</span></span><br><span class="line"><span class="keyword">void</span>    processProxyMessage(boolean messageIsRequest, IInterceptedProxyMessage message)</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line">public class BurpExtender implements IBurpExtender, IProxyListener&#123;</span><br><span class="line"> </span><br><span class="line">    public PrintWriter stdout;</span><br><span class="line">    public IExtensionHelpers helpers;</span><br><span class="line">    private IBurpExtenderCallbacks callbacks;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true);</span><br><span class="line">        this.callbacks &#x3D; callbacks;</span><br><span class="line">        this.helpers &#x3D; callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerProxyListener(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void processProxyMessage(boolean messageIsRequest,</span><br><span class="line">            IInterceptedProxyMessage message) &#123;</span><br><span class="line">            &#x2F;&#x2F; TODO here</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IRequestInfo"><a href="#IRequestInfo" class="headerlink" title="IRequestInfo"></a>IRequestInfo</h3><h4 id="public-interface-IRequestInfo"><a href="#public-interface-IRequestInfo" class="headerlink" title="public interface IRequestInfo"></a>public interface IRequestInfo</h4><p>此接口被用于获取一个 HTTP 请求的详细信息。扩展插件可以通过调用 IExtensionHelpers.analyzeRequest() 获得一个 IRequestInfo 对象。</p>
<p>此接口提供了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 HTTP body 在请求消息中的起始偏移量</span><br><span class="line">int getBodyOffset()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取请求消息的 HTTP 类型</span><br><span class="line">byte    getContentType()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取请求中包含的 HTTP 头</span><br><span class="line">java.util.List&lt;java.lang.String&gt;    getHeaders()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取请求的 HTTP 方法</span><br><span class="line">java.lang.String    getMethod()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取请求中包含的参数</span><br><span class="line">java.util.List&lt;IParameter&gt;  getParameters()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取请求中的 URL</span><br><span class="line">java.net.URL    getUrl()</span><br></pre></td></tr></table></figure>

<p>Demo code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BurpExtender</span> <span class="title">implements</span> <span class="title">IBurpExtender</span>, <span class="title">IHttpListener</span>&#123;</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> PrintWriter <span class="built_in">stdout</span>;</span><br><span class="line">    <span class="keyword">public</span> IExtensionHelpers helpers;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerExtenderCallbacks</span><span class="params">(<span class="keyword">final</span> IBurpExtenderCallbacks callbacks)</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">this</span>.<span class="built_in">stdout</span> = <span class="keyword">new</span> PrintWriter(callbacks.getStdout(), <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.helpers = callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(<span class="string">&quot;Her0in&quot;</span>);</span><br><span class="line">        callbacks.registerHttpListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processHttpMessage</span><span class="params">(<span class="keyword">int</span> toolFlag, boolean messageIsRequest,</span></span></span><br><span class="line"><span class="function"><span class="params">            IHttpRequestResponse messageInfo)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 打印出请求的 Url 和 响应码</span></span><br><span class="line">        <span class="keyword">if</span>(messageIsRequest)&#123;</span><br><span class="line">            <span class="built_in">stdout</span>.println(helpers.bytesToString(messageInfo.getRequest()));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            IResponseInfo responseInfo = helpers.analyzeResponse(messageInfo.getResponse());</span><br><span class="line">            <span class="keyword">short</span> statusCode = responseInfo.getStatusCode();</span><br><span class="line">            <span class="built_in">stdout</span>.<span class="built_in">printf</span>(<span class="string">&quot;响应码 =&gt; %d\r\n&quot;</span>, statusCode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加载上述代码生成的插件后，执行效果如下图所示：</p>
<p><img src="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/11.jpg" alt="img"></p>
<h3 id="IResponseInfo"><a href="#IResponseInfo" class="headerlink" title="IResponseInfo"></a>IResponseInfo</h3><h4 id="public-interface-IResponseInfo"><a href="#public-interface-IResponseInfo" class="headerlink" title="public interface IResponseInfo"></a>public interface IResponseInfo</h4><p>此接口被用于获取一个 HTTP 请求的详细信息。扩展插件可以通过调用 IExtensionHelpers. analyzeResponse() 获得一个 IResponseInfo 对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 HTTP body 在响应消息中的起始偏移量</span><br><span class="line">int getBodyOffset()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取响应消息中设置的 HTTP Cookie</span><br><span class="line">java.util.List&lt;ICookie&gt; getCookies()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取包含在响应消息中的 HTTP 头</span><br><span class="line">java.util.List&lt;java.lang.String&gt;    getHeaders()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取根据 HTTP 响应判断出的 MIME 类型</span><br><span class="line">java.lang.String    getInferredMimeType()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 HTTP 响应头中指示的 MIME 类型</span><br><span class="line">java.lang.String    getStatedMimeType()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取 HTTP 状态码</span><br><span class="line">short   getStatusCode()</span><br></pre></td></tr></table></figure>

<p>Demo code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BurpExtender</span> <span class="title">implements</span> <span class="title">IBurpExtender</span>, <span class="title">IHttpListener</span>&#123;</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> PrintWriter <span class="built_in">stdout</span>;</span><br><span class="line">    <span class="keyword">public</span> IExtensionHelpers helpers;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerExtenderCallbacks</span><span class="params">(<span class="keyword">final</span> IBurpExtenderCallbacks callbacks)</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">this</span>.<span class="built_in">stdout</span> = <span class="keyword">new</span> PrintWriter(callbacks.getStdout(), <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.helpers = callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(<span class="string">&quot;Her0in&quot;</span>);</span><br><span class="line">        callbacks.registerHttpListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processHttpMessage</span><span class="params">(<span class="keyword">int</span> toolFlag, boolean messageIsRequest,</span></span></span><br><span class="line"><span class="function"><span class="params">            IHttpRequestResponse messageInfo)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 打印出请求的 Url 和 响应码</span></span><br><span class="line">        <span class="keyword">if</span>(messageIsRequest)&#123;</span><br><span class="line">            <span class="built_in">stdout</span>.println(helpers.bytesToString(messageInfo.getRequest()));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            IResponseInfo responseInfo = helpers.analyzeResponse(messageInfo.getResponse());</span><br><span class="line">            <span class="keyword">short</span> statusCode = responseInfo.getStatusCode();</span><br><span class="line">            <span class="built_in">stdout</span>.<span class="built_in">printf</span>(<span class="string">&quot;响应码 =&gt; %d\r\n&quot;</span>, statusCode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IScanIssue"><a href="#IScanIssue" class="headerlink" title="IScanIssue"></a>IScanIssue</h3><h4 id="public-interface-IScanIssue"><a href="#public-interface-IScanIssue" class="headerlink" title="public interface IScanIssue"></a>public interface IScanIssue</h4><p>此接口用于获取 Scanner 工具扫描到的问题的细节。扩展可以通过注册一个 IScannerListener或者是 通过调用 IBurpExtenderCallbacks.getScanIssues() 获取扫描问题的细节。扩展同样可以通过注册 IScannerCheck 接口或者是调用 IBurpExtenderCallbacks.addScanIssue() 方法来自定义扫描问题，此时扩展需要提供它对此接口的实现。</p>
<p>此接口提供了以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描问题的信任等级</span><br><span class="line">java.lang.String    getConfidence()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回生成扫描问题所对应的 HTTP 消息</span><br><span class="line">IHttpRequestResponse[]  getHttpMessages()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回生成扫描问题所对应的 HTTP 服务信息</span><br><span class="line">IHttpService    getHttpService()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回指定扫描问题类型的背景描述信息</span><br><span class="line">java.lang.String    getIssueBackground()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回指定的扫描问题的详细信息</span><br><span class="line">java.lang.String    getIssueDetail()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描问题类型的名称</span><br><span class="line">java.lang.String    getIssueName()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描问题类型的数字标志符</span><br><span class="line">int getIssueType()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回指定扫描问题的解决方式的背景描述信息</span><br><span class="line">java.lang.String    getRemediationBackground()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回指定扫描问题的解决方式的背景详情</span><br><span class="line">java.lang.String    getRemediationDetail()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描问题的错误等级</span><br><span class="line">java.lang.String    getSeverity()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回生成扫描问题对应的 URL 信息</span><br><span class="line">java.net.URL    getUrl()</span><br></pre></td></tr></table></figure>

<p>Demo code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请见 IScannerListener 的实例代码。</span><br></pre></td></tr></table></figure>

<h3 id="IScannerCheck"><a href="#IScannerCheck" class="headerlink" title="IScannerCheck"></a>IScannerCheck</h3><h4 id="public-interface-IScannerCheck"><a href="#public-interface-IScannerCheck" class="headerlink" title="public interface IScannerCheck"></a>public interface IScannerCheck</h4><p>扩展可以实现此接口，之后可以通过调用 IBurpExtenderCallbacks.registerScannerCheck()注册一个自定义的 Scanner 工具的检查器。Burp 将会告知检查器执行“主动扫描”或“被动扫描”，并且在确认扫描到问题时给出报告。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 当自定义的Scanner工具的检查器针对同一个 URL 路径报告了多个扫描问题时，Scanner 工具会调用此方法</span><br><span class="line">int consolidateDuplicateIssues(IScanIssue existingIssue, IScanIssue newIssue)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; Scanner 工具会对每一个可插入的点执行“主动扫描”</span><br><span class="line">java.util.List&lt;IScanIssue&gt;  doActiveScan(IHttpRequestResponse baseRequestResponse, IScannerInsertionPoint insertionPoint)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; Scanner 工具会对每一个可插入的点执行“被动扫描”</span><br><span class="line">java.util.List&lt;IScanIssue&gt;  doPassiveScan(IHttpRequestResponse baseRequestResponse)</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line">import java.util.List;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IScannerCheck&#123;</span><br><span class="line"> </span><br><span class="line">    public PrintWriter stdout;</span><br><span class="line">    public IExtensionHelpers helpers;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true);</span><br><span class="line">        this.helpers &#x3D; callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerScannerCheck(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;IScanIssue&gt; doPassiveScan(</span><br><span class="line">            IHttpRequestResponse baseRequestResponse) &#123;</span><br><span class="line">        &#x2F;&#x2F; TODO here</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;IScanIssue&gt; doActiveScan(</span><br><span class="line">            IHttpRequestResponse baseRequestResponse,</span><br><span class="line">            IScannerInsertionPoint insertionPoint) &#123;</span><br><span class="line">        &#x2F;&#x2F; TODO here</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public int consolidateDuplicateIssues(IScanIssue existingIssue,</span><br><span class="line">            IScanIssue newIssue) &#123;</span><br><span class="line">        &#x2F;&#x2F; TODO here</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IScannerInsertionPoint"><a href="#IScannerInsertionPoint" class="headerlink" title="IScannerInsertionPoint"></a>IScannerInsertionPoint</h3><h4 id="public-interface-IScannerInsertionPoint"><a href="#public-interface-IScannerInsertionPoint" class="headerlink" title="public interface IScannerInsertionPoint"></a>public interface IScannerInsertionPoint</h4><p>此接口被用于定义一个用于Scanner工具检查器扫描的插入点。扩展可以通过注册 IScannerCheck 获得此接口实例，或者通过注册 IScannerInsertionPointProvider 创建一个 Burp 所使用的扫描检查器实例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">&#x2F;&#x2F; 此方法用于使用指定的 payload 在插入点构建一个请求</span><br><span class="line">byte[]  buildRequest(byte[] payload)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回插入点的基本值</span><br><span class="line">java.lang.String    getBaseValue()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回插入点的名称</span><br><span class="line">java.lang.String    getInsertionPointName()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回插入点的类型，插入点类型在IScannerInsertionPoint接口中定义</span><br><span class="line">byte    getInsertionPointType()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 当使用指定的 payload 替换到插入点时，此方法可以决定 payload 在请求中的偏移量</span><br><span class="line">int[]   getPayloadOffsets(byte[] payload)</span><br></pre></td></tr></table></figure>

<p>Demo code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请见 IScannerCheck 的实例代码。  </span><br></pre></td></tr></table></figure>

<h3 id="IScannerInsertionPointProvider"><a href="#IScannerInsertionPointProvider" class="headerlink" title="IScannerInsertionPointProvider"></a>IScannerInsertionPointProvider</h3><h4 id="public-interface-IScannerInsertionPointProvider"><a href="#public-interface-IScannerInsertionPointProvider" class="headerlink" title="public interface IScannerInsertionPointProvider"></a>public interface IScannerInsertionPointProvider</h4><p>扩展可以实现此接口并且可以通过调用 IBurpExtenderCallbacks.registerScannerInsertionPointProvider() 注册自定义扫描插入点的工厂。</p>
<p>此接口提供了以下方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!java</span></span><br><span class="line"><span class="comment">// 当扫描请求为“主动扫描”时， Scanner 工具将会调用此方法，并且提供者应该提供一个自定义插入点的列表以便用于扫描</span></span><br><span class="line">java.util.<span class="keyword">List</span>&lt;IScannerInsertionPoint&gt;  getInsertionPoints(IHttpRequestResponse baseRequestResponse)</span><br></pre></td></tr></table></figure>

<h3 id="IScannerListener"><a href="#IScannerListener" class="headerlink" title="IScannerListener"></a>IScannerListener</h3><h4 id="public-interface-IScannerListener"><a href="#public-interface-IScannerListener" class="headerlink" title="public interface IScannerListener"></a>public interface IScannerListener</h4><p>扩展可以实现此接口，并且可以通过调用 IBurpExtenderCallbacks.registerScannerListener() 注册一个 Scanner 工具的监听器。当 Scanner 工具扫描到新的问题时，会通知此监听器。扩展通过注册这样的监听器用于针对扫描问题自定义的分析和记录。</p>
<p>此接口提供了以下方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line"><span class="comment">// 当一个新的扫描问题被添加到 Burp 的Scanner工具的扫描结果中时，此方法将被 Burp 调用</span></span><br><span class="line"><span class="keyword">void</span>    newScanIssue(IScanIssue issue)</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BurpExtender</span> <span class="title">implements</span> <span class="title">IBurpExtender</span>, <span class="title">IScannerListener</span>&#123;</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> PrintWriter <span class="built_in">stdout</span>;</span><br><span class="line">    <span class="keyword">public</span> IExtensionHelpers helpers;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerExtenderCallbacks</span><span class="params">(<span class="keyword">final</span> IBurpExtenderCallbacks callbacks)</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">this</span>.<span class="built_in">stdout</span> = <span class="keyword">new</span> PrintWriter(callbacks.getStdout(), <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.helpers = callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(<span class="string">&quot;Her0in&quot;</span>);</span><br><span class="line">        callbacks.registerScannerListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">newScanIssue</span><span class="params">(IScanIssue issue)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="built_in">stdout</span>.println(<span class="string">&quot;扫描到新的问题 :&quot;</span>);</span><br><span class="line">        <span class="built_in">stdout</span>.println(<span class="string">&quot;url =&gt; &quot;</span> + issue.getUrl());     </span><br><span class="line">        <span class="built_in">stdout</span>.println(<span class="string">&quot;详情 =&gt; &quot;</span> + issue.getIssueDetail());  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加载上述代码生成的插件后，执行效果如下图所示：</p>
<p><img src="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/12.jpg" alt="img"></p>
<h3 id="IScanQueueItem"><a href="#IScanQueueItem" class="headerlink" title="IScanQueueItem"></a>IScanQueueItem</h3><h4 id="public-interface-IScanQueueItem"><a href="#public-interface-IScanQueueItem" class="headerlink" title="public interface IScanQueueItem"></a>public interface IScanQueueItem</h4><p>此接口被用于获取在 Burp 的 Scanner 工具中激活的扫描队列里的项目详情。扩展可以通过调用 IBurpExtenderCallbacks.doActiveScan() 获得扫描队列项目的引用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">&#x2F;&#x2F; 此方法可以取消扫描队列项目中的扫描状态</span><br><span class="line">void    cancel()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 获取扫描队列项目生成的问题的细节</span><br><span class="line">IScanIssue[]    getIssues()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描队列项目发生错误时的网络错误号</span><br><span class="line">int getNumErrors()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描队列项目的攻击插入点的数量</span><br><span class="line">int getNumInsertionPoints()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描队列项目已经发出的请求的数量</span><br><span class="line">int getNumRequests()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描队列项目中已经完成扫描的百分比</span><br><span class="line">byte    getPercentageComplete()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法返回扫描队列项目的状态描述</span><br><span class="line">java.lang.String    getStatus()</span><br></pre></td></tr></table></figure>

<h3 id="IScopeChangeListener"><a href="#IScopeChangeListener" class="headerlink" title="IScopeChangeListener"></a>IScopeChangeListener</h3><h4 id="public-interface-IScopeChangeListener"><a href="#public-interface-IScopeChangeListener" class="headerlink" title="public interface IScopeChangeListener"></a>public interface IScopeChangeListener</h4><p>扩展可以实现此接口并且可以通过调用 IBurpExtenderCallbacks.registerScopeChangeListener() 注册一个 Target 工具下的 scope 变化监听器。当 Burp 的 Target 工具下的 scope 发生变化时，将会通知此接口。</p>
<p>此接口提供了以下方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line"><span class="comment">// 当 Burp 的 Target 工具下的 scope 发生变化时，将会调用此方法。</span></span><br><span class="line"><span class="keyword">void</span>    scopeChanged()</span><br></pre></td></tr></table></figure>

<p>Demo code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, IScopeChangeListener&#123;</span><br><span class="line"> </span><br><span class="line">    public PrintWriter stdout;</span><br><span class="line">    public IExtensionHelpers helpers;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true);</span><br><span class="line">        this.helpers &#x3D; callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        callbacks.registerScopeChangeListener(this);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void scopeChanged() &#123;</span><br><span class="line">        &#x2F;&#x2F; 手动添加或右键菜单添加目标到 scope 列表，就会执行此方法</span><br><span class="line">        stdout.println(&quot;scope 有变化！&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加载上述代码生成的插件后，执行效果如下图所示：</p>
<p><img src="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/13.jpg" alt="img"></p>
<h3 id="ISessionHandlingAction"><a href="#ISessionHandlingAction" class="headerlink" title="ISessionHandlingAction"></a>ISessionHandlingAction</h3><h4 id="public-interface-ISessionHandlingAction"><a href="#public-interface-ISessionHandlingAction" class="headerlink" title="public interface ISessionHandlingAction"></a>public interface ISessionHandlingAction</h4><p>扩展可以实现此方法并且可以通过调用 IBurpExtenderCallbacks.registerSessionHandlingAction() 注册一个自定义的会话操作动作。每一个已注册的会话操作动作在会话操作规则的UI中都是可用的，并且用户可以选择其中一个作为会话操作行为的规则。用户可以选择直接调用操作，也可以按照宏定义调用操作。</p>
<p>此接口调用了如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!java      </span><br><span class="line">&#x2F;&#x2F; 此方法由 Burp 调用获取会话操作行为的名称</span><br><span class="line">java.lang.String    getActionName()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 当会话操作行为被执行时会调用此方法</span><br><span class="line">void    performAction(IHttpRequestResponse currentRequest, IHttpRequestResponse[] macroItems)</span><br></pre></td></tr></table></figure>

<h3 id="ITab"><a href="#ITab" class="headerlink" title="ITab"></a>ITab</h3><h4 id="public-interface-ITab"><a href="#public-interface-ITab" class="headerlink" title="public interface ITab"></a>public interface ITab</h4><p>此接口用于自定义的标签页，调用 IBurpExtenderCallbacks.addSuiteTab() 方法可以在 Burp 的 UI 中显示自定义的标签页。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取自定义标签的标题文本</span><br><span class="line">java.lang.String    getTabCaption()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; Burp 调用此方法获取自定义标签页显示的组件</span><br><span class="line">java.awt.Component  getUiComponent()</span><br></pre></td></tr></table></figure>

<p>Demo code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">package burp;</span><br><span class="line"> </span><br><span class="line">import java.awt.Component;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">import javax.swing.JButton;</span><br><span class="line">import javax.swing.JPanel;</span><br><span class="line">import javax.swing.SwingUtilities;</span><br><span class="line"> </span><br><span class="line">public class BurpExtender implements IBurpExtender, ITab&#123;</span><br><span class="line"> </span><br><span class="line">    public PrintWriter stdout;</span><br><span class="line">    public IExtensionHelpers helpers;</span><br><span class="line"> </span><br><span class="line">    private JPanel jPanel1;</span><br><span class="line">    private JButton jButton1;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123;</span><br><span class="line"> </span><br><span class="line">        this.stdout &#x3D; new PrintWriter(callbacks.getStdout(), true);</span><br><span class="line">        this.helpers &#x3D; callbacks.getHelpers();</span><br><span class="line">        callbacks.setExtensionName(&quot;Her0in&quot;);</span><br><span class="line">        SwingUtilities.invokeLater(new Runnable() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                 &#x2F;&#x2F;创建一个 JPanel</span><br><span class="line">                 jPanel1 &#x3D; new JPanel();</span><br><span class="line">                 jButton1 &#x3D; new JButton(&quot;点我&quot;);</span><br><span class="line"> </span><br><span class="line">                 &#x2F;&#x2F; 将按钮添加到面板中</span><br><span class="line">                 jPanel1.add(jButton1);</span><br><span class="line"> </span><br><span class="line">                 &#x2F;&#x2F;自定义的 UI 组件</span><br><span class="line">                 callbacks.customizeUiComponent(jPanel1);</span><br><span class="line">                 &#x2F;&#x2F;将自定义的标签页添加到Burp UI 中</span><br><span class="line">                 callbacks.addSuiteTab(BurpExtender.this);</span><br><span class="line">            &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public String getTabCaption() &#123;</span><br><span class="line">        &#x2F;&#x2F; 返回自定义标签页的标题</span><br><span class="line">        return &quot;Her0in&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public Component getUiComponent() &#123;</span><br><span class="line">        &#x2F;&#x2F; 返回自定义标签页中的面板的组件对象</span><br><span class="line">        return jPanel1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加载上述代码生成的插件后，执行效果如下图所示：</p>
<p><img src="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BAPI%E7%AF%87/Python/md文件处理/BurpSuite插件开发指南之API篇/14.jpg" alt="img"></p>
<h3 id="ITempFile"><a href="#ITempFile" class="headerlink" title="ITempFile"></a>ITempFile</h3><h4 id="public-interface-ITempFile"><a href="#public-interface-ITempFile" class="headerlink" title="public interface ITempFile"></a>public interface ITempFile</h4><p>此接口用于操作调用 IBurpExtenderCallbacks.saveToTempFile() 创建的临时文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!java</span><br><span class="line">&#x2F;&#x2F; 删除临时文件，此方法已过时</span><br><span class="line">void    delete()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取临时文件内容的缓冲区</span><br><span class="line">byte[]  getBuffer()</span><br></pre></td></tr></table></figure>

<h3 id="ITextEditor"><a href="#ITextEditor" class="headerlink" title="ITextEditor"></a>ITextEditor</h3><h4 id="public-interface-ITextEditor"><a href="#public-interface-ITextEditor" class="headerlink" title="public interface ITextEditor"></a>public interface ITextEditor</h4><p>此接口用于扩展 Burp 的 原始文本编辑器，扩展通过调用 IBurpExtenderCallbacks.createTextEditor() 获得一个此接口的实例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#!java  </span><br><span class="line">&#x2F;&#x2F; 此方法返回用于扩展添加自定义的编辑器的 UI 组件</span><br><span class="line">java.awt.Component  getComponent()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取当前的已选择的文本</span><br><span class="line">byte[]  getSelectedText()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取用户在已显示的文本中选择的边界</span><br><span class="line">int[]   getSelectionBounds()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于获取当前已显示的文本</span><br><span class="line">byte[]  getText()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于指示用户是否对编辑器的内容做了修改</span><br><span class="line">boolean isTextModified()</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于决定当前的编辑器是否可编辑</span><br><span class="line">void    setEditable(boolean editable)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于更新编辑器下边的搜索框的搜索表达式</span><br><span class="line">void    setSearchExpression(java.lang.String expression)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 此方法用于更新编辑器中当前已显示的文本</span><br><span class="line">void    setText(byte[] text)</span><br></pre></td></tr></table></figure>

<p>Demo code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请见 IMessageEditorTabFactory 的实例代码。</span><br></pre></td></tr></table></figure>

<p>转自：<a target="_blank" rel="noopener" href="https://www.tuicool.com/articles/aaaa6fA">https://www.tuicool.com/articles/aaaa6fA</a></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/03/31/Burp-Extender-Apis-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91-%E9%9B%86%E5%90%88/" rel="prev" title="Burp Extender Apis 插件开发">
      <i class="fa fa-chevron-left"></i> Burp Extender Apis 插件开发
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BJava%E7%AF%87/" rel="next" title="BurpSuite插件开发指南之Java篇">
      BurpSuite插件开发指南之Java篇 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8B-API-%E4%B8%8A%E4%B8%8B%E7%AF%87"><span class="nav-number">1.</span> <span class="nav-text">BurpSuite插件开发指南之 API(上下篇)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x00-%E5%89%8D%E8%A8%80"><span class="nav-number">1.1.</span> <span class="nav-text">0x00 前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-BurpSuite-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%AF%B4%E6%98%8E"><span class="nav-number">1.2.</span> <span class="nav-text">0x01 BurpSuite 插件开发说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SDK%EF%BC%9A"><span class="nav-number">1.2.0.1.</span> <span class="nav-text">SDK：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E5%8F%91-IDE%EF%BC%9A"><span class="nav-number">1.2.0.2.</span> <span class="nav-text">开发 IDE：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7%EF%BC%9A"><span class="nav-number">1.2.0.3.</span> <span class="nav-text">辅助工具：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-API-%E5%8F%82%E8%80%83"><span class="nav-number">1.3.</span> <span class="nav-text">0x02 API 参考</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#IBurpExtender-%E6%8E%A5%E5%8F%A3"><span class="nav-number">1.3.1.</span> <span class="nav-text">IBurpExtender 接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IBurpExtender"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">public interface IBurpExtender</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IBurpExtenderCallbacks"><span class="nav-number">1.3.2.</span> <span class="nav-text">IBurpExtenderCallbacks</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IBurpExtenderCallbacks"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">public interface IBurpExtenderCallbacks</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IContextMenuFactory"><span class="nav-number">1.3.3.</span> <span class="nav-text">IContextMenuFactory</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IContextMenuFactory"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">public interface IContextMenuFactory</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IContextMenuInvocation"><span class="nav-number">1.3.4.</span> <span class="nav-text">IContextMenuInvocation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IContextMenuInvocation"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">public interface IContextMenuInvocation</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ICookie"><span class="nav-number">1.3.5.</span> <span class="nav-text">ICookie</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-ICookie"><span class="nav-number">1.3.5.1.</span> <span class="nav-text">public interface ICookie</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IExtensionHelpers"><span class="nav-number">1.3.6.</span> <span class="nav-text">IExtensionHelpers</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IExtensionHelpers"><span class="nav-number">1.3.6.1.</span> <span class="nav-text">public interface IExtensionHelpers</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IExtensionStateListener"><span class="nav-number">1.3.7.</span> <span class="nav-text">IExtensionStateListener</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IExtensionStateListener"><span class="nav-number">1.3.7.1.</span> <span class="nav-text">public interface IExtensionStateListener</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IHttpListener"><span class="nav-number">1.3.8.</span> <span class="nav-text">IHttpListener</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IHttpListener"><span class="nav-number">1.3.8.1.</span> <span class="nav-text">public interface IHttpListener</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IHttpRequestResponse"><span class="nav-number">1.3.9.</span> <span class="nav-text">IHttpRequestResponse</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IHttpRequestResponse"><span class="nav-number">1.3.9.1.</span> <span class="nav-text">public interface IHttpRequestResponse</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IHttpRequestResponsePersisted"><span class="nav-number">1.3.10.</span> <span class="nav-text">IHttpRequestResponsePersisted</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IHttpRequestResponsePersisted-extends-IHttpRequestResponse"><span class="nav-number">1.3.10.1.</span> <span class="nav-text">public interface IHttpRequestResponsePersisted extends IHttpRequestResponse</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IHttpRequestResponseWithMarkers"><span class="nav-number">1.3.11.</span> <span class="nav-text">IHttpRequestResponseWithMarkers</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IHttpRequestResponseWithMarkers-extends-IHttpRequestResponse"><span class="nav-number">1.3.11.1.</span> <span class="nav-text">public interface IHttpRequestResponseWithMarkers extends IHttpRequestResponse</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IHttpService"><span class="nav-number">1.3.12.</span> <span class="nav-text">IHttpService</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IHttpService"><span class="nav-number">1.3.12.1.</span> <span class="nav-text">public interface IHttpService</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IInterceptedProxyMessage"><span class="nav-number">1.3.13.</span> <span class="nav-text">IInterceptedProxyMessage</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IInterceptedProxyMessage"><span class="nav-number">1.3.13.1.</span> <span class="nav-text">public interface IInterceptedProxyMessage</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IIntruderAttack"><span class="nav-number">1.3.14.</span> <span class="nav-text">IIntruderAttack</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IIntruderAttack"><span class="nav-number">1.3.14.1.</span> <span class="nav-text">public interface IIntruderAttack</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IIntruderPayloadGenerator"><span class="nav-number">1.3.15.</span> <span class="nav-text">IIntruderPayloadGenerator</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IIntruderPayloadGenerator"><span class="nav-number">1.3.15.1.</span> <span class="nav-text">public interface IIntruderPayloadGenerator</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IIntruderPayloadGeneratorFactory"><span class="nav-number">1.3.16.</span> <span class="nav-text">IIntruderPayloadGeneratorFactory</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IIntruderPayloadGeneratorFactory"><span class="nav-number">1.3.16.1.</span> <span class="nav-text">public interface IIntruderPayloadGeneratorFactory</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IIntruderPayloadProcessor"><span class="nav-number">1.3.17.</span> <span class="nav-text">IIntruderPayloadProcessor</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IIntruderPayloadProcessor"><span class="nav-number">1.3.17.1.</span> <span class="nav-text">public interface IIntruderPayloadProcessor</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IMenuItemHandler"><span class="nav-number">1.3.18.</span> <span class="nav-text">IMenuItemHandler</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IMenuItemHandler"><span class="nav-number">1.3.18.1.</span> <span class="nav-text">public interface IMenuItemHandler</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IMessageEditor"><span class="nav-number">1.3.19.</span> <span class="nav-text">IMessageEditor</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IMessageEditor"><span class="nav-number">1.3.19.1.</span> <span class="nav-text">public interface IMessageEditor</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IMessageEditorController"><span class="nav-number">1.3.20.</span> <span class="nav-text">IMessageEditorController</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IMessageEditorController"><span class="nav-number">1.3.20.1.</span> <span class="nav-text">public interface IMessageEditorController</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IMessageEditorTab"><span class="nav-number">1.3.21.</span> <span class="nav-text">IMessageEditorTab</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IMessageEditorTab"><span class="nav-number">1.3.21.1.</span> <span class="nav-text">public interface IMessageEditorTab</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IMessageEditorTabFactory"><span class="nav-number">1.3.22.</span> <span class="nav-text">IMessageEditorTabFactory</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IMessageEditorTabFactory"><span class="nav-number">1.3.22.1.</span> <span class="nav-text">public interface IMessageEditorTabFactory</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%EF%BC%9A%E5%AE%98%E7%BD%91%E6%8F%90%E4%BE%9B%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B6%88%E6%81%AF%E7%BC%96%E8%BE%91%E5%99%A8%E7%9A%84%E4%BB%A3%E7%A0%81%E6%9C%89%E8%AF%AF%EF%BC%81"><span class="nav-number">1.3.22.2.</span> <span class="nav-text">注意：官网提供的自定义消息编辑器的代码有误！</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IParameter"><span class="nav-number">1.3.23.</span> <span class="nav-text">IParameter</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IParameter"><span class="nav-number">1.3.23.1.</span> <span class="nav-text">public interface IParameter</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IProxyListener"><span class="nav-number">1.3.24.</span> <span class="nav-text">IProxyListener</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IProxyListener"><span class="nav-number">1.3.24.1.</span> <span class="nav-text">public interface IProxyListener</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IRequestInfo"><span class="nav-number">1.3.25.</span> <span class="nav-text">IRequestInfo</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IRequestInfo"><span class="nav-number">1.3.25.1.</span> <span class="nav-text">public interface IRequestInfo</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IResponseInfo"><span class="nav-number">1.3.26.</span> <span class="nav-text">IResponseInfo</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IResponseInfo"><span class="nav-number">1.3.26.1.</span> <span class="nav-text">public interface IResponseInfo</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IScanIssue"><span class="nav-number">1.3.27.</span> <span class="nav-text">IScanIssue</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IScanIssue"><span class="nav-number">1.3.27.1.</span> <span class="nav-text">public interface IScanIssue</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IScannerCheck"><span class="nav-number">1.3.28.</span> <span class="nav-text">IScannerCheck</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IScannerCheck"><span class="nav-number">1.3.28.1.</span> <span class="nav-text">public interface IScannerCheck</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IScannerInsertionPoint"><span class="nav-number">1.3.29.</span> <span class="nav-text">IScannerInsertionPoint</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IScannerInsertionPoint"><span class="nav-number">1.3.29.1.</span> <span class="nav-text">public interface IScannerInsertionPoint</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IScannerInsertionPointProvider"><span class="nav-number">1.3.30.</span> <span class="nav-text">IScannerInsertionPointProvider</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IScannerInsertionPointProvider"><span class="nav-number">1.3.30.1.</span> <span class="nav-text">public interface IScannerInsertionPointProvider</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IScannerListener"><span class="nav-number">1.3.31.</span> <span class="nav-text">IScannerListener</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IScannerListener"><span class="nav-number">1.3.31.1.</span> <span class="nav-text">public interface IScannerListener</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IScanQueueItem"><span class="nav-number">1.3.32.</span> <span class="nav-text">IScanQueueItem</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IScanQueueItem"><span class="nav-number">1.3.32.1.</span> <span class="nav-text">public interface IScanQueueItem</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IScopeChangeListener"><span class="nav-number">1.3.33.</span> <span class="nav-text">IScopeChangeListener</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-IScopeChangeListener"><span class="nav-number">1.3.33.1.</span> <span class="nav-text">public interface IScopeChangeListener</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ISessionHandlingAction"><span class="nav-number">1.3.34.</span> <span class="nav-text">ISessionHandlingAction</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-ISessionHandlingAction"><span class="nav-number">1.3.34.1.</span> <span class="nav-text">public interface ISessionHandlingAction</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ITab"><span class="nav-number">1.3.35.</span> <span class="nav-text">ITab</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-ITab"><span class="nav-number">1.3.35.1.</span> <span class="nav-text">public interface ITab</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ITempFile"><span class="nav-number">1.3.36.</span> <span class="nav-text">ITempFile</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-ITempFile"><span class="nav-number">1.3.36.1.</span> <span class="nav-text">public interface ITempFile</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ITextEditor"><span class="nav-number">1.3.37.</span> <span class="nav-text">ITextEditor</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#public-interface-ITextEditor"><span class="nav-number">1.3.37.1.</span> <span class="nav-text">public interface ITextEditor</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="一灯和尚"
      src="/images/46807619.jpg">
  <p class="site-author-name" itemprop="name">一灯和尚</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      大佬们
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://assassins-white.github.io/" title="https:&#x2F;&#x2F;assassins-white.github.io&#x2F;" rel="noopener" target="_blank">Assassins小白博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.ji4n.cn/" title="http:&#x2F;&#x2F;www.ji4n.cn&#x2F;" rel="noopener" target="_blank">Jen博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.le31ei.top/" title="https:&#x2F;&#x2F;blog.le31ei.top&#x2F;" rel="noopener" target="_blank">le31ei博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.lele8.me/" title="https:&#x2F;&#x2F;www.lele8.me&#x2F;" rel="noopener" target="_blank">回梦博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">一灯和尚</span>
</div>
  <div class="powered-by">一只安全小菜鸡
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
